<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="Preliminary RISC-V HFI Spec (v1)">
<meta name="author" content="Authors: Shravan Narayan (UT Austin), Tal Garfinkel (UC San Diego),Ravi Sahita (Rivos), Deepak Gupta (Rivos), Ziang Tian (UT Austin)">
<title>Preliminary RISC-V HFI Spec (v1)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Preliminary RISC-V HFI Spec (v1)</h1>
<div class="details">
<span id="author" class="author">Authors: Shravan Narayan (UT Austin), Tal Garfinkel (UC San Diego),Ravi Sahita (Rivos), Deepak Gupta (Rivos), Ziang Tian (UT Austin)</span><br>
<span id="revnumber">version v1,</span>
<span id="revdate">7/2025</span>
<br><span id="revremark">Draft</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_list_of_figures">List of figures</a></li>
<li><a href="#_list_of_tables">List of tables</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#sec_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_hfi_execution_model">1.1. HFI Execution Model</a></li>
<li><a href="#_base_hfi_extension">1.2. Base HFI Extension</a></li>
<li><a href="#_explicit_hfi_extension">1.3. Explicit HFI Extension</a></li>
</ul>
</li>
<li><a href="#sec_hfi_base">2. Base HFI Extension</a>
<ul class="sectlevel2">
<li><a href="#sub_sec_sbx_setup">2.1. Sandbox Setup</a></li>
<li><a href="#sub_sec_exit_handler">2.2. Configuring the Exit handler</a></li>
<li><a href="#sub_sec_regions">2.3. Regions</a>
<ul class="sectlevel3">
<li><a href="#subsec_region_types">2.3.1. Regions Types</a></li>
<li><a href="#subsec_manip_regions">2.3.2. Manipulating Regions</a></li>
<li><a href="#_implementation_considerations">2.3.3. Implementation Considerations</a></li>
</ul>
</li>
<li><a href="#sub_sec_regs">2.4. New Internal Registers</a>
<ul class="sectlevel3">
<li><a href="#_sandbox_status_register">2.4.1. Sandbox Status Register</a></li>
<li><a href="#_exit_handler_registers">2.4.2. Exit Handler Registers</a></li>
<li><a href="#_region_registers">2.4.3. Region Registers</a></li>
<li><a href="#sec_hfi_faults">2.4.4. Fault Registers</a></li>
</ul>
</li>
<li><a href="#sub_sec_using_hfi">2.5. Using HFI</a>
<ul class="sectlevel3">
<li><a href="#_sandboxing_in_userspace">2.5.1. Sandboxing in Userspace</a></li>
<li><a href="#subsec_os_integration">2.5.2. OS (and VMM) integration</a></li>
</ul>
</li>
<li><a href="#sub_sec_instruction_encoding">2.6. Instruction Encoding</a></li>
<li><a href="#sub_sec_pending_considerations">2.7. Pending Design Considerations</a>
<ul class="sectlevel3">
<li><a href="#_streamlining_control_transfers_for_native_binaries">2.7.1. Streamlining Control Transfers for Native Binaries</a></li>
<li><a href="#_hfi_in_m_mode_or_s_mode">2.7.2. HFI in M-mode or S-mode</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec_hfi_explicit">3. Explicit HFI Extension</a>
<ul class="sectlevel2">
<li><a href="#_region_characteristics">3.1. Region Characteristics</a></li>
<li><a href="#_configuring_and_accessing_explicit_regions">3.2. Configuring and Accessing Explicit Regions</a></li>
<li><a href="#_fault_registers">3.3. Fault Registers</a></li>
<li><a href="#_explicit_instruction_encoding">3.4. Explicit Instruction Encoding</a>
<ul class="sectlevel3">
<li><a href="#_base_loads_and_stores">3.4.1. Base Loads and Stores</a></li>
<li><a href="#_floating_point_loads_and_stores">3.4.2. Floating Point Loads and Stores</a></li>
<li><a href="#_vector_memory_operations">3.4.3. Vector Memory Operations</a></li>
<li><a href="#_atomic_memory_operations">3.4.4. Atomic Memory Operations</a></li>
</ul>
</li>
<li><a href="#sub_subsec_standard_profile">3.5. HFI Versions (Profiles)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_list_of_figures">List of figures</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#fig_r_type">Figure 1.</a> R-type instruction format.<br>
<a href="#fig_enc_base">Figure 2.</a> H-prefixed Base Loads and Stores<br>
<a href="#fig_enc_fp">Figure 3.</a> H-prefixed floating point loads and stores<br>
<a href="#fig_enc_vec">Figure 4.</a> H-prefixed vector loads and stores<br>
<a href="#fig_enc_amo">Figure 5.</a> H-prefixed atomic loads, stores and other atomic operations<br></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_list_of_tables">List of tables</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#tab_enc_non_h">Table 1.</a> Encoding for R-type Non-h-prefixed Instructions<br>
<a href="#tab_enc_base">Table 2.</a> Encodings for h-prefixed base loads and stores<br>
<a href="#tab_enc_fp">Table 3.</a> Encodings for h-prefixed FP loads and stores<br>
<a href="#tab_enc_vec">Table 4.</a> Field encodings for vector loads and stores<br>
<a href="#tab_enc_base_amo">Table 5.</a> Encodings for h-prefixed atomic memory instructions<br>
<a href="#tab_enc_non_h_explicit">Table 6.</a> Encoding for R-type Non-h-prefixed Instructions (Explicit Only)<br></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributors">Contributors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This HFI RISC-V specification has been contributed to directly or indirectly by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Shravan Narayan &lt;<a href="mailto:required1@email.com">required1@email.com</a>&gt;</p>
</li>
<li>
<p>Tal Garfinkel &lt;<a href="mailto:required2@email.com">required2@email.com</a>&gt;</p>
</li>
<li>
<p>Ravi Sahita &lt;<a href="mailto:required3@email.com">required3@email.com</a>&gt;</p>
</li>
<li>
<p>Deepak Gupta &lt;<a href="mailto:required4@email.com">required4@email.com</a>&gt;</p>
</li>
<li>
<p>Ziang Tian &lt;<a href="mailto:ztian@utexas.edu">ztian@utexas.edu</a>&gt;</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hardware-assisted Fault Isolation (HFI) is a hardware extension designed to support in-process isolation (sandboxing) of untrusted code. It targets both unmodified native binaries and existing Software-Based Fault Isolation (SFI <span class="citation">(<a href="#wahbe-sfi">Wahbe et al.&#44; 1993</a>)</span>) systems, such as WebAssembly <span class="citation">(<a href="#wasm">Haas et al.&#44; 2017</a>)</span> and Google&#8217;s Ubercage (V8 JIT sandbox <span class="citation">(<a href="#v8-sbx">saelo&#44; 2021</a>)</span>), to improve their performance, security, and scalability <span class="citation">(<a href="#hfi">Narayan et al.&#44; 2023</a>)</span>.</p>
</div>
<div class="paragraph">
<p>HFI aims to provide the capabilities required for secure sandboxing: robust data and control flow isolation, as well as complete and efficient mediation of privileged instructions (e.g., system calls). This specification describes the functional properties of HFI on RISC-V; a more complete description of the background and motivation is presented in the ASPLOS 2023 paper <span class="citation">(<a href="#hfi">Narayan et al.&#44; 2023</a>)</span>.</p>
</div>
<div class="sect2">
<h3 id="_hfi_execution_model">1.1. HFI Execution Model</h3>
<div class="paragraph">
<p>To support these capabilities, HFI defines a shared execution model involving a privileged runtime and a restricted sandbox mode. The code responsible for managing the sandbox is referred to as the <em>sandboxing runtime</em>. The runtime is responsible for saving and restoring context appropriately and can use HFI to multiplex many sandboxes across harts, scheduling them as it sees fit. The runtime controls the transition into the sandbox using the <code>hfienter</code> instruction and regains control when the sandboxed code executes an <code>hfiexit</code> instruction. When a hart operates in HFI Mode, execution is restricted to ensure isolation. To prevent the sandbox from bypassing these restrictions, HFI interposes on all paths out of the sandbox, ensuring the runtime can completely mediate all control flow and access to sensitive OS resources.</p>
</div>
<div class="paragraph">
<p>To address diverse sandboxing requirements—ranging from legacy native binaries to modern SFI runtimes—HFI is divided into two distinct extensions: the Base HFI Extension and the HFI Explicit Extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_base_hfi_extension">1.2. Base HFI Extension</h3>
<div class="paragraph">
<p>The Base HFI extension is the foundational layer of HFI, designed primarily to enable the secure sandboxing of unmodified native binaries and libraries. For native code to run inside a sandbox without modification or recompilation, it must be able to use standard RISC-V load, store, and jump instructions. The Base extension achieves this natural isolation by overlaying the standard address space with Implicit Data and Implicit Code regions. These regions transparently apply bounds checks to every standard memory access and instruction fetch performed by the sandboxed code, allowing native binaries to operate normally while determining access permissions on a first-match basis.</p>
</div>
<div class="paragraph">
<p>To ensure the native binary cannot bypass the sandbox or access sensitive OS resources, the Base extension hardens its sandbox by trapping and redirecting privileged operations, specifically system calls. Moreover, to prevent guest application from explicitly calling sandbox exits, sandbox exit instructions are also interposed on. Both system calls and sandbox exits are redirected to a trusted exit handler that can be configured by the runtime.</p>
</div>
<div class="paragraph">
<p>This extension provides the core Interposition and Implicit Region logic necessary for coarse-grained isolation. The Base HFI extension is specified in <a href="#sec_hfi_base">Chapter 2</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_explicit_hfi_extension">1.3. Explicit HFI Extension</h3>
<div class="paragraph">
<p>The HFI Explicit extension builds upon the Base HFI extension to accelerate existing Software-Based Fault Isolation (SFI) technologies. This extension requires the Base HFI extension to be implemented and targets runtimes that utilize a linear memory model, such as WebAssembly. While the Base extension targets standard memory models, SFI runtimes often require memory access to be relative to a specific heap base with precise bounds.</p>
</div>
<div class="paragraph">
<p>The HFI Explicit extension offloads the software overhead of bound-checking these accesses to hardware through two mechanisms. First, it provides Explicit Data Regions which, unlike the coarse-grained power-of-two sizing of implicit regions, support byte-granular sizing critical for exact heap bounds. Second, it introduces dedicated h-prefixed instructions (e.g., <code>hlw</code>, <code>hsw</code>) that perform region-relative addressing. By using these instructions, an SFI compiler can map software linear memory directly to hardware regions, allowing the hardware to perform bound checks automatically and eliminating the need for costly software guard instructions. The HFI Explicit extension is specified in <a href="#sec_hfi_explicit">Chapter 3</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec_hfi_base">2. Base HFI Extension</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sub_sec_sbx_setup">2.1. Sandbox Setup</h3>
<div class="paragraph">
<p>The sandboxing runtime can query if the processor supports HFI by checking the supported extension string from the device tree or the ACPI RISC-V Hart Capabilities Table as is the common practice <span class="citation">(<a href="#riscv-ext-cpuid">Jones&#44; 2023</a>)</span>. Specifically, the string will list "hfi-<em>version</em>" if HFI is supported. The HFI version described in this spec is "1".</p>
</div>
<div class="paragraph">
<p>If HFI is supported, HFI mode is enabled with the <code>hfienter</code> instruction, and disabled with the <code>hfiexit</code> instruction. The <code>hfienter</code> instruction has two variants---the first variant takes a single register operand which specifies the sandbox configuration options as a bit vector called <code>hfioptions_t</code>, that has the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>lock_regions</em>: <em>reg_u1</em>---Regions configurations are normally specified prior to <code>hfienter</code>, using instructions such <code>hfisetregionsize</code> (See <a href="#sub_sec_regions">Chapter 2.3</a>). If <em>lock_regions</em> is set to <em>false (0)</em>, region manipulation instructions can also be called while in HFI mode (i.e., the region configuration can be modified in the sandbox). If <em>true (1)</em>, these instructions cannot be called while in HFI mode.</p>
</li>
<li>
<p><em>redirect_system_calls</em>: <em>reg_u1</em>---HFI sandboxes can interpose on system calls made by sandboxed code. If <em>redirect_system_calls</em> is set to <em>false (0)</em>, system calls are unaffected by HFI. If <em>true (1)</em>, HFI will redirect system calls (<code>ecall</code>) instructions to the HFI exit handler (which can be set with the <code>hfisetexithandler</code> instruction discussed in <a href="#sub_sec_exit_handler">Chapter 2.2</a>).</p>
</li>
<li>
<p><em>redirect_exits</em>: <em>reg_u1</em>---HFI sandboxes can interpose on invocations of <code>hfiexit</code> so the application can take control once the sandbox code completes. If <em>redirect_exits</em> is set to <em>false (0)</em>, <code>hfiexit</code> disables HFI and execution simply falls through to the next instruction. If <em>true (1)</em>, <code>hfiexit</code> disables HFI and redirects control flow to the exit_handler (which can be set with the <code>hfisetexithandler</code> instruction discussed in <a href="#sub_sec_exit_handler">Chapter 2.2</a>).</p>
</li>
<li>
<p><em>serialize_enter_exits</em>: <em>reg_u1</em>---HFI sandboxes can add fences sandbox entries and exit (through the <code>hfienter</code> and <code>hfiexit</code> instructions), a required step for Spectre protections. If <em>serialize_enter_exits</em> is <em>false (0)</em>, these instructions do not introduce any serialization or fencing. If <em>true (1)</em>, these instructions act as a fence for all memory operations that are run prior to these instructions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second variant of <code>hfienter</code> operates like <code>hfienter</code> variant 1 plus a jump instruction; it takes the <code>hfioptions_t</code> as the first operand and takes the target of the jump in a register as the second operand.</p>
</div>
<div class="paragraph">
<p><strong>Behavior</strong>
The <code>hfienter</code> instruction interacts with multiple internal registers. It sets the field <code>hfiusermodeenabled</code> in an internal register <code>hfistatusreg</code> to 1 on execution, and clears the <code>hfifaultoccurred</code> field in another internal register <code>hfifaultstatusreg</code> indicating that there has not been a violation of HFI&#8217;s region rules since the last invocation of <code>hfienter</code>. The second variant of <code>hfienter</code> additionally sets the PC to the target specified in the second operand after its execution.
The <code>hfiexit</code> instruction interacts with all three fields from <code>hfistatusreg</code>. It sets its <code>hfiusermodeenabled</code> field to 0 on execution, write the value of the program counter of the <code>hfiexit</code> instruction to its <code>hfiexitpc</code> field, and set its <code>hfiexitreason</code> field to 1, indicating the sandbox exit was due to and <code>hfiexit</code> instruction.
<code>hfienter</code> and <code>hfiexit</code> must always act as fence for other HFI instructions, i.e., they only execute after all in-flight HFI instructions have completed.</p>
</div>
<div class="paragraph">
<p><strong>Faults</strong>
The <code>hfienter</code> instruction will trap if the CPU is already in HFI mode. The <code>hfiexit</code> instruction will trap if the CPU is not in HFI mode.</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
Most of the options in <code>hfioptions_t</code> are present to support different use cases. When executing unmodified native code, the sandboxed code is totally untrusted, thus regions are locked, system calls are redirected, etc. However, when sandboxing code from existing SFI systems such as WebAssembly, it is more efficient/not necessary for HFI to do some checks, since these systems already handle some safety checks in their compiler/runtime. For example, these systems may not want to redirect system calls.
Similarly, the choice of whether or not to serialize <code>hfiexit</code> and <code>hfienter</code> will depend on the threat model that a particular application is trying to enforce (i.e. if they want greater Spectre safety), we leave it to the user to choose whether they wish to opt into this added overhead. Finally, <code>hfienter</code> is offered in two variants as some sandboxing runtimes may want the option to jump directly to executing sandboxed code after sandboxing is enabled via <code>hfienter</code>, while other runtimes may want the instruction to fall through to avoid any costs due to extra control flow. The former behavior can be difficult to accomplish with the single operand variant of <code>hfienter</code> as it requires the instruction following <code>hfienter</code> to be part of the sandbox&#8217;s code---which may not always be possible. The latter behavior&#8217;s performance is difficult to achieve with an instruction that includes control flow.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub_sec_exit_handler">2.2. Configuring the Exit handler</h3>
<div class="paragraph">
<p>HFI supports interposition via. redirection on all paths out of the sandbox including sandbox exits (via. <code>hfiexit</code>) and system calls (and by extension signals). As noted, which instructions (system calls and/or <code>hfiexit</code>) are redirected is configured through <code>hfioptions_t</code>, that is passed as an operand to <code>hfienter</code>.</p>
</div>
<div class="paragraph">
<p>To handle this redirection, an exit handler is setup with the <code>hfisetexithandler</code> instruction. This instruction should be invoked prior to <code>hfiexit</code>. <code>hfisetexithandler</code> takes one operand, a 64-bit register, that holds the address of the exit handler. The current exit handler can be retrieved via the <code>hfigetexithandler</code> instruction.</p>
</div>
<div class="paragraph">
<p><strong>Behavior</strong>
The <code>hfisetexithandler</code> instruction sets the <code>hfiexithandlerreg</code> internal register to the address specified in its operand.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>hfiexit</code> is configured to invoke the exit handler, the <code>hfiexit</code> instruction, when executed by sandbox code, will jump to the exit handler <em>after</em> execution (during which <code>hfiexitreason</code> in <code>hfistatusreg</code> is set to 1 indicating the exit was due to the <code>hfiexit</code> instruction).</p>
</li>
<li>
<p>If system calls are configured to invoke the exit handler, the system call instruction, when executed by sandbox code, will jump to the exit handler <em>before</em> execution, set the <code>hfiexitreason</code> field to 2 indicating the exit was due to a system call, and disable sandboxing by setting the <code>hfiusermodeenabled</code> field to 0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Faults</strong>
The <code>hfisetexithandler</code> instruction will trap if the CPU is already in HFI mode. If the exit handler is set to a location without code permissions, the behavior of the CPU would be identical to a normal jump to an address without code permissions.</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
Sandboxed code will invoke <code>hfiexit</code> to exit the sandbox. We must ensure that the sandboxed code always returns control to the sandboxing runtime after exits, which means, invocation of <code>hfiexit</code> should return control to trusted code. Thus, we have added support for redirecting all invocations of <code>hfiexit</code>.</p>
</div>
<div class="paragraph">
<p>Sandboxed code can also invoke system calls; since HFI&#8217;s restrictions don&#8217;t apply to kernel code, system calls could be used to bypass isolation enforced by the hardware <span class="citation">(<a href="#pku-pitfalls">Connor et al.&#44; 2020</a>)</span>. Thus, trusted code needs the ability to interpose on system calls, so that it can restrict the invocation of unsafe system calls by sandboxed code. Such interposition on system calls could be done using assembly rewriting or using kernel features such as EBPF, however, this is slow and cumbersome. To allow efficient interposition of system calls, HFI provides hardware support to redirect system calls. When enabled, system calls simply act like a jump instruction to the exit handler.</p>
</div>
</div>
<div class="sect2">
<h3 id="sub_sec_regions">2.3. Regions</h3>
<div class="paragraph">
<p>Regions offer a limited version of the functionality found in traditional segmented memory systems, which control access to contiguous ranges of memory using <code>&lt;base, bound, permission&gt;</code> tuples.</p>
</div>
<div class="paragraph">
<p>By default, a processor in HFI mode has no access to memory, i.e. it cannot read data or run code. To enable sandboxed code to run, a sandbox runtime must explicitly configure regions prior executing <code>hfienter</code>. In the next sections, we provide a brief overview of HFI regions, and then specify how to configure these them.</p>
</div>
<div class="sect3">
<h4 id="subsec_region_types">2.3.1. Regions Types</h4>
<div class="paragraph">
<p>HFI base extension provides regions that <em>implicitly</em> apply bound checks to every memory access when the sandbox is enabled. These regions are thus also called "implicit regions". This is essential for isolating memory accesses and control flow of unmodified native code. HFI discriminates such regions into code and data ones, to keep the control and data pipelines simpler and more efficient. Data regions can grant read and write access and only apply to loads and stores, while code regions apply only to instruction fetches, and can only grant execute permissions.</p>
</div>
<div class="paragraph">
<p>With every memory access under bound checks, data regions grant access on a first-match basis. For example, if sandboxed code executes an &#8220;lw rd, rs(offset)&#8221; instruction, HFI will check if the address in <code>rs + offset</code> is in range for <em>any</em> of the existing regions in parallel. For the first matching region, it will check the permissions to see if reads are allowed&#8201;&#8212;&#8201;if so, it will proceed. If the permission check fails, or if there is no match, HFI will trap. Code regions apply similar checks to code.</p>
</div>
<div class="paragraph">
<p>Specifically, regions perform bound checks based on <em>prefix matching</em>. Each region specifies a <em>base_prefix</em> (the <code>base</code> component in the region&#8217;s tuple) and an <em>lsb_mask</em> (the <code>bound</code> component in the region&#8217;s tuple). To check if an address is in bounds, HFI uses the <em>lsb_mask</em> to remove the least significant bits of the address, and compares the remaining prefix to <em>base_prefix</em>.
Thus, regions must be power of two sized and aligned&#8201;&#8212;&#8201;thus, they trade granularity for efficient checking&#8201;&#8212;&#8201;in particular, checks can be implemented with simple masking operations.</p>
</div>
<div class="paragraph">
<p><strong>Notes on size and alignment</strong>
Unaligned memory operations that are split by the micro-architecture into independent operations will be checked independently by HFI. If one split faults, the original fused instruction will fault, as will the split instruction that violates HFI bounds. However, the split operation that is within bounds may be allowed to have visible <em>micro-architectural</em> side effects within the sandbox.</p>
</div>
<div class="paragraph">
<p>Regions also have minimum sizes. The smallest implicit region is 64 bytes. The behavior of regions that do not meet these minimums is undefined.</p>
</div>
</div>
<div class="sect3">
<h4 id="subsec_manip_regions">2.3.2. Manipulating Regions</h4>
<div class="paragraph">
<p>Region state, which is stored in internal registers, can only be read or modified by HFI instructions. The instructions broadly operate on regions by a region number (<code>region_number_t</code>)&#8201;&#8212;&#8201;a unique number/index assigned to each HFI region on the CPU.</p>
</div>
<div class="paragraph">
<p><strong>Region number assignments</strong>
The version of HFI in this spec (hfi1) up to this chapter defines two regions: one implicit data region of <code>region_number_t</code> of 1, and one implicit data region of <code>region_number_t</code> of 2. Future versions may define multiple regions of each type (<a href="#sub_subsec_standard_profile">Chapter 3.5</a>), and each region will be assigned a unique <code>region_number_t</code>.</p>
</div>
<div class="paragraph">
<p>We now introduce the instructions that can configure these regions:</p>
</div>
<div class="paragraph">
<p><strong>Setting Region base and size</strong>
The following instructions are used to specify the range of memory a region applies to. To configure a specific region&#8217;s base and size, a sandboxing runtime must first select the target region. This is accomplished by direct instructions that write to a dedicated register indicating current region being configured. Once a region is selected, its base address and mask (bound) can be configured using separate instructions that target dedicated registers. This approach breaks down the operation to fit standard RISC-V instruction formats, avoiding having multiple destination registers.</p>
</div>
<div class="paragraph">
<p><code>hfiselectregion</code>(<em>region_number_t</em>)</p>
</div>
<div class="paragraph">
<p><code>hfisetregionbase</code>(<em>reg_u64 base</em>)</p>
</div>
<div class="paragraph">
<p><code>hfigetregionbase</code>() &#8594; <em>reg_u64 base</em></p>
</div>
<div class="paragraph">
<p><code>hfisetregionbound</code>(<em>reg_u64 mask_or_bound</em>)</p>
</div>
<div class="paragraph">
<p><code>hfigetregionbound</code>() &#8594; <em>reg_u64 mask_or_bound</em></p>
</div>
<div class="paragraph">
<p><strong>Behaviour</strong>
The region to configure is set with <code>hfiselectregion</code>, and then its sizes and locations are set using <code>hfisetregionbase</code> and <code>hfisetregionbound</code>. Regions are typically setup prior to entering the sandbox (with <code>hfienter</code>). If this instruction runs in a sandbox, i.e., <code>hfiusermodeenabled</code> is 1&#8201;&#8212;&#8201;which is allowed when <code>lock_regions</code> is 0&#8201;&#8212;&#8201;it must act as a memory fence. All prior memory instructions must complete before executing this instruction and subsequent memory operations should be issued only after the update.</p>
</div>
<div class="paragraph">
<p><code>hfiselectregion</code> has <code>region_number_t</code> as its operand register, and works closely with the other four instructions. While <code>hfisetregionbase</code> has the base of the region as its operand, `hfisetregionbound&#8217;s operand depends on the type of region. The third operand should contain the mask for the region. The value of the base and bound/mask should additionally conform to the per-region size and alignment requirements in <a href="#subsec_region_types">Chapter 2.3.1</a>. However, the instruction does not check whether operands meet this criteria. If the operands don&#8217;t meet the criteria, the resulting behavior is undefined.</p>
</div>
<div class="paragraph">
<p><code>hfigetregionbound</code>, <code>hfigetregionbase</code>, and <code>hfigetregionbound</code> return region size information based on the previously fed <code>region_number_t</code>.</p>
</div>
<div class="paragraph">
<p><strong>Faults</strong>
These instructions fault if the region number specified does not exist (i.e., it is greater than the total number of regions). For efficiency, these instructions should not check whether region locations or sizes are invalid (e.g., the program has specifies an implicit region base that is not aligned to its size); rather the hardware will continue to operate using the provided base and size, although this behavior is to be considered undefined.</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
When <code>hfisetregionsize</code> is run prior to <code>hfienter</code>, it doesn&#8217;t need to act as a fence as <code>hfienter</code> can fulfill this purpose. However, when used inside the sandbox, <code>hfisetregionsize</code> must act as a fence, as otherwise inflight memory operations could potentially access memory outside the sandbox when they were issued if a region resized.</p>
</div>
<div class="paragraph">
<p><strong>Setting Permissions, Enabling/Disabling Regions</strong>
The following instructions are used to configure permissions on regions, as well as to enable and disable regions.</p>
</div>
<div class="paragraph">
<p><code>hfisetregionpermission</code>(<em>permission_set_t</em>, <em>permission_t</em>)</p>
</div>
<div class="paragraph">
<p><code>hfigetregionpermission</code>(<em>permission_set_t</em>) &#8594; <em>permission_t</em></p>
</div>
<div class="paragraph">
<p><strong>Behaviour</strong>
Region permissions are set using the <code>hfisetregionpermission</code> instruction. This instruction sets the permissions of all regions using a single bit vector. The instruction takes <code>permission_set_t</code> as the first argument. This is a 32-bit register which must have the value 0; other values are reserved for future use. The second operand to this instruction is a permission bit-vector <code>permission_t</code> encoded as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bits 0 to 2 are permissions for implicit data region 1. Bit 0 indicates if the region is enabled (i.e., should be enforced by the sandbox). Bit 1 and 2 indicates whether the region has read and write permissions respectively.</p>
</li>
<li>
<p>Bits 3 to 4 are permissions for implicit data region 1. Bit 3 indicates if the region is enabled. Bit 4 indicates whether the region has execute permissions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Faults</strong>
This instruction will fault if the <code>permission_set_t</code> is not set to 0, or if <code>hfiusermodeenabled</code> and <code>lock_regions</code> is set to 1 (when hfi mode is on with region configurations locked). Any unused bits of <code>permission_t</code> are ignored; thus setting an unused bit will not fault.</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
An alternate design for this instruction would be to split up <code>hfisetregionpermission</code> to operate per-region (by changing the instruction to take <code>region_number_t</code> to operate on as the first parameter). However, this would lead to additional overheads in practice. This is because this instruction is primarily used when switching between active sandboxes. In this case, the permissions of all regions would likely need to be adjusting. If <code>hfisetregionpermission</code> operated per region, then three calls to this instruction would be needed to adjust the permissions of the three regions. In contrast, our design allows this to occur in a single instruction. Additionally, the <code>permission_set_t</code> parameter further future-proofs this design by allowing us to modify the format of this instruction for future versions of HFI, without breaking backward compatibility.</p>
</div>
<div class="paragraph">
<p><strong>Clearing Regions</strong>
To clear region state rapidly e.g. on context switches, HFI offers <code>hfiresetregions</code>.</p>
</div>
<div class="paragraph">
<p><strong>Behaviour</strong>
This instruction sets the base and bound/mask of all regions to zero (equivalent to calling <code>hfisetregionsize</code> with arguments of 0 on all regions), disables all regions and sets their permissions to zero (equivalent to calling <code>hfisetregionpermission</code> with a permission vector of 0).</p>
</div>
<div class="paragraph">
<p><strong>Faults</strong>
This instruction faults if <code>hfiusermodeenabled</code> and <code>lock_regions</code> is set to 1 (when hfi mode is on with region configurations locked).</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
While this instruction can effectively be achieved using combinations of other instructions, unifying this "reset" operation into a single instruction allows optimizing a number of paths. For example, when an application needs to switch between multiple sandboxes, software has to clear the state of the first sandbox before applying the state of the second sandbox. This allows optimizing the first step sequence. This operation is also useful when the OS kernel is switching between two scheduled processes both of which may use HFI. The OS kernel is responsible for saving and restoring each processes' HFI state, and thus can also use this instruction.</p>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_considerations">2.3.3. Implementation Considerations</h4>
<div class="paragraph">
<p><strong>Implementation Semantics and Spectre</strong>  To ensure Spectre safety, the following guidance is offered for implementers.</p>
</div>
<div class="paragraph">
<p><em>For code regions:</em> To ensure security, prefix-checking should be carried out in parallel with the decode stage. If the check finds a matching region with execute permissions, it succeeds, and decode carries on normally. If the check fails, it prevents the decoded micro-ops from entering the pipeline, and instead translates all instructions into a faulting NOP micro-op. This ensures that instructions that are out-of-bounds are not executed during committed execution, and are also not executed speculatively.</p>
</div>
<div class="paragraph">
<p><em>For data regions:</em> Bounds checking, DTLB lookup, and cache index lookups should happen in parallel. One concern here is that, cache state could be modified as a result of secret (out-of-bounds) data. To prevent this sort of side-channel attack all bounds must checks occur <em>before</em> the processor resolves the physical address of a memory access. This is secure because the processor can update cache metadata like the LRU bits (for hits) or fetch new data blocks (for misses) only after resolving the physical address. HFI can therefore strictly prevent any metadata updates if there has been a fault.</p>
</div>
<div class="paragraph">
<p>Note that out-of-bounds address can affect metadata of the DTLB or i-cache---e.g., LRU bits. However, the invariant we guarantee---no secret (data stored outside the boundaries of the region) ever affects architectural state---is still not violated, since we do not allow the <em>result</em> of an out-of-bounds memory operation to propagate into any of these structure.</p>
</div>
<div class="paragraph">
<p>To summarize, HFI&#8217;s data pipeline is Spectre safe, since the data cache is not updated prior to bounds checks being completed; HFI&#8217;s control pipeline is safe as bounds checks finish prior to instruction decode which is before the execution of instructions. This approach also helps to guarantee that any code executed as the result of PHT, BTB, and RSB (speculative) predictions are checked prior to execution.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub_sec_regs">2.4. New Internal Registers</h3>
<div class="paragraph">
<p>HFI stores state for the current sandbox in internal registers including: (1) the sandbox status (2) the exit handler (3) region configuration (4) the cause and status of HFI induced faults (traps).</p>
</div>
<div class="sect3">
<h4 id="_sandbox_status_register">2.4.1. Sandbox Status Register</h4>
<div class="paragraph">
<p><strong>Fields</strong>
The sandbox status, stored in the <code>hfistatusreg</code> internal register, is read-only to userspace software, but writable by kernel code. The contents of the <code>hfistatusreg</code> register are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>hfi_usermode_enabled</em> (1-bit): is updated automatically during <code>hfienter</code> (set to true), <code>hfiexit</code> (set to false), and when the exit handler is called (set to false).</p>
</li>
<li>
<p><em>hfi_exit_reason</em> (2-bit): indicates the reason for the last sandbox exit. Exit due to <code>hfiexit</code> would leave this set to 1. Exit due to a system call with leave this set to 2.</p>
</li>
<li>
<p><em>hfi_exit_pc</em> (60-bit): indicates the PC of the instruction causing the last exit. The first 2-bits and the last 2-bits of the PC are dropped and are assumed to be zero. Thus 60-bits of the PC are stored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Serialization Caveat</strong>
The <code>hfistatusreg</code> register should support updates via register renaming to support the performance expectations of hardware sandboxing. These values are expected to change frequently (once in few thousand instructions), and serializing this register updates with techniques like score-boarding will hinder practical adoption.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exit_handler_registers">2.4.2. Exit Handler Registers</h4>
<div class="paragraph">
<p><strong>Fields</strong>
The address of the sandbox exit handler is stored in the <code>hfiexithandlerreg</code> internal register. When a sandboxed hart traps or executes an <code>hfiexit</code> instruction, the Program Counter (PC) is set to the value stored in this register. This register is written to using the <code>hfisetexithandler</code> instruction and read using the <code>hfigetexithandler</code> instruction. The contents of the <code>hfiexithandlerreg</code> register are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Exit Handler Address</em> (60-bit): indicates the address of the exit handler set for current sandbox. The first 2 bits and last 2 bits of this address are dropped and assumed to be zero.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Serialization Caveat</strong>
The exit handler of the sandbox is stored in the <code>hfiexithandlerreg</code> internal register and can be set or read via the <code>hfisetexithandler</code> and <code>hfigetexithandler</code> instructions. Since the register is not expected to be frequently updated, it&#8217;s updates may be scoreboarded if needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_region_registers">2.4.3. Region Registers</h4>
<div class="paragraph">
<p><strong>Fields</strong>
There are three sets of internal registers dedicated to region configurations required by hfi: bounds registers, permissions registers, and selector registers. Different version of HFI may require different numbers of these registers, as discussed in <a href="#sub_subsec_standard_profile">Chapter 3.5</a>. Bounds registers specify the bounds and sizes of a region. Each implicit region (data or code) has a 64-bit prefix register and a 64-bit mask register. Permissions registers specify whether a region can be read, written, or executed. Each data region has a 1-bit write field and a 1-bit read field, while each code region has a 1-bit execute field. On top of these registers is the selector register, which contains the region number of the region currently being configured. Its only field is a 32-bit <code>region_number_t</code>.</p>
</div>
<div class="paragraph">
<p><strong>Serialization Caveat</strong>
The region registers cannot be directly named, and must instead be modified or accessed through HFI instructions (e.g. <code>hfigetregionsize</code>). Since these registers should updated whenever a sandbox switch occurs, updates to these registers should ideally be supported through register renaming; however, implementations may choose to use the slightly less expensive scheme.
In particular, implementations can configure the regions outside the sandbox without serializing, and defer fencing to when an <code>hfienter</code> instruction executes. This way, updates to these registers do not fence, and the <code>hfienter</code> instruction waits for all pending region register updates to complete. When a sandbox is enabled (<code>hfiusermodeenabled</code> set to 1), region register updates are not permitted if <code>lock_regions</code> option is set to 0. In the case that the region is not locked, however, all updates to the region register within the sandbox must serialize.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec_hfi_faults">2.4.4. Fault Registers</h4>
<div class="paragraph">
<p><strong>Fields</strong>
The result of an HFI fault due to an HFI policy violation is stored in the <code>hfifaultstatusreg</code> register. This register stores the precise cause of an HFI induced fault (trap). Since the register is not expected to be frequently updated, it’s updates may be scoreboarded if needed. Information in <code>hfifaultstatusreg</code> is readable in user space so the runtime can respond appropriately, and read-write in the kernel so that this state can be saved/restored as part of the process context, as multiple processes may be using HFI, and fault delivery is asynchronous. This register has four fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>hfi_fault_occurred</em> (1-bit): is a bit that indicates that an hfi fault has occurred.</p>
</li>
<li>
<p><em>hfi_fault_region</em> (8-bit): indicates which region the fault occured in. If the fault was caused by an implicit region i.e. insufficient permission to access a matched region, it will contain the number of the region. If the fault was cause because no implicit region matched an operation, it will contain 0.</p>
</li>
<li>
<p><em>hfi_fault_op</em> (2-bit): indicates the operation that faulted, this will be a <code>LOAD_FAULT</code> or <code>STORE_FAULT</code> for a failed load or store, <code>FETCH_FAULT</code> for a failed instruction fetch, or <code>AMO_FAULT</code> for a fault that occurred during an atomic memory operation.</p>
</li>
<li>
<p><em>hfi_fault_type</em> (1-bit): indicates the type of fault. If <code>OUT_OF_BOUNDS</code>, it indicates that no implicit region matched the operation (in this case <code>hfi_fault_region</code> will be equal to zero). If <code>INSUFFICIENT_PERMISSIONS</code>, whichever implicit region matched the operation did not have sufficient permissions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong>
The <code>hfienter</code> and <code>hfiexit</code> instructions modify the various bits of the <code>hfistatusreg</code> register. The updates to this register must be fast to allow rapid entries and exits to HFI mode; thus this must be supported by register renaming. Region registers are updated frequently as well when switching between different sandboxes. While this would ideally support register renaming for efficient register updates, an alternate scheme that ensures a single serialization (on entry into the sandbox) for a batch of region updates prior to entry, would provide adequate performance. Finally, updates to the region configuration within the sandbox should serialize, as an updates during speculative execution may allow Spectre-style attacks to break out of the sandbox.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub_sec_using_hfi">2.5. Using HFI</h3>
<div class="paragraph">
<p>Here we explore how HFI&#8217;s features are used to create sandboxing runtimes in userspace, and the HFI support needed from the operating systems.</p>
</div>
<div class="sect3">
<h4 id="_sandboxing_in_userspace">2.5.1. Sandboxing in Userspace</h4>
<div class="paragraph">
<p>Suppose we have a sandbox runtime (e.g. part of an application implementing a Wasm FaaS server, or a library sandboxing framework <span class="citation">(<a href="#rlbox"><em>The RLBox Sandboxing Toolkit</em>&#44; 2024</a>)</span>), that is ready to create new sandbox.
We assume that the runtime has reserved some memory for the sandbox (i.e., the sandbox memory), has placed the input for the sandboxed code in a memory buffer, and the sandboxed code itself is separated from other code and mapped in an isolated contiguous portion of the address space. Our runtime can now take the following steps:</p>
</div>
<div class="paragraph">
<p><strong>Setting up regions</strong>
To start, our runtime sets up access to the code, heap, and input memory so our application has everything it needs once the sandbox starts, it does this using the <code>hfisetregionsize</code>, <code>hfisetregionpermission</code> instructions to setup and enable regions that grant access to the allocated heap and inputs, and the application code. If no code regions are mapped, HFI will immediately trap after <code>hfi_enter</code> is called, as the processor will not be able to fetch instructions.</p>
</div>
<div class="paragraph">
<p>What type of regions the runtime will use, as as how the sandbox is configured will depend on if it is sandboxing a native or SFI (e.g. Wasm) based application.</p>
</div>
<div class="paragraph">
<p><strong>Sandboxing Native code</strong>
When sandboxing native code, the code being sandboxed is entirely untrusted, and thus, it cannot be allowed to modify any of HFI&#8217;s state, or exit the sandbox in unexpected ways, or perform any other operation that would allow it to violate the sandbox&#8217;s policy. Thus, the sandbox options flags in <code>hfioptions_t</code> that are passed to <code>hfienter</code> to start the sandbox will: set the <code>lock_regions</code> flag to 1 (true), since sandboxed code cannot be trusted to modify regions; set the <code>redirect_system_calls</code> flag to 1, as again this code can&#8217;t be trusted to perform system calls directly; set the <code>redirect_exit</code> flag to 1, ensuring all control flow out of the sandbox is redirect to the trusted runtime. The runtime will use an implicit data region to permit the sandboxed code to use of the sandbox memory; the runtime will then ensure the sandboxed code&#8217;s stack, heap and inputs are part of this implicit region. An implicit code regions will be used to mark the code of the sandbox.</p>
</div>
<div class="paragraph">
<p><strong>Sandboxing using SFI runtimes</strong>
When sandboxing code through SFI runtimes such as a Wasm runtime, sandboxing is handled as a mix of compiler/software-runtime checks as well as hardware checks from HFI. In the scenario, implementer has confidence in the correctness of the SFI&#8217;s runtime and compiler, and thus their use of HFI is different from sandboxing code, giving it greater flexibility and performance.</p>
</div>
<div class="paragraph">
<p>For example, on <code>hfienter</code> it can set the <code>lock_regions</code> flag to 0 (false), allowing the compiler/runtime to modify regions with <code>hfisetregionsize</code> and <code>hfisetregionpermission</code> without having to exit the sandbox. This can allow regions to be used more flexibly, e.g. it can load and spilling registers, and never need to exit the sandbox. The <code>redirect_system_calls</code> flag can also be set to 0 (false), as the Wasm compiler disallows direct access to system call instructions, ensuring that any system calls made will come from the trusted runtime, this can eliminate the overhead of unecessary sandbox exits. What the redirect_exit flag will be set to depends on the SFI implementation, it may set this flag to false and opt to let sandbox exit&#8217;s fall through to minimize overhead, since it can ensure that it knows that it can control whatever instruction follows an <code>hfiexit</code>, or it may opt to set it to true, and setup an exit_handler. For granting access to memory, the runtime will use implicit regions for code and data.</p>
</div>
<div class="paragraph">
<p><strong>Saving context</strong>
A sandboxing runtime must protect its own execution context such as its stack and contents of CPU registers, before it switches to sandbox code. HFI leaves this mechanism entirely up to software---this flexibility is important for efficiency. For example, if our runtime is running untrusted native code---it will have to use springboards and trampolines <span class="citation">(<a href="#nacl">Yee et al.&#44; 2009</a>)</span>---lightweight assembly routines that (1) clear registers and switch to a separate stack prior to executing the sandboxed code and (2) restore these registers after the sandboxed is executed. However, if it is running Wasm code, it could opt to use zero-cost transitions <span class="citation">(<a href="#zero-cost">Kolosick et al.&#44; 2022</a>)</span> that rely on the compiler to ensure that the sandbox code cannot misuse the stack or scratch registers.</p>
</div>
<div class="paragraph">
<p><strong>Setting up an exit handler</strong>
If our runtime needs an exit handler either to handle <code>hfiexit</code> or redirected system calls, it will need to setup an exit handler with <code>hfisetexithandler</code>. This exit handler is implemented as a normal function call in the runtime that takes no arguments. It will query the <code>hfiexitreason</code> CSR to find out why it was invoked.</p>
</div>
<div class="paragraph">
<p><strong>Entering the sandbox</strong>
Having taken all these steps, our runtime is ready to start the sandbox. Once it calls <code>hfi_enter</code>, HFI mode is enabled, and the next instruction that runs will be inside a sandbox.</p>
</div>
<div class="paragraph">
<p><strong>The exit handler (<code>hfiexit</code> and system calls)</strong>
When the exit handler is called after the sandbox exits, it will transfer control to the exit handler function in the runtime, which will check a control and status register (CSR) to identify the cause of the exit, and respond appropriately.</p>
</div>
<div class="paragraph">
<p>For example, for sandbox exits, it will need to save context unless the sandbox execution has completed. Similarly for system calls, it will need to save context, but then also execute whatever additional logic is need to check the parameters of the system call for safety and finally invoking the system call <span class="citation">(<a href="#pku-pitfalls">Connor et al.&#44; 2020</a>)</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="subsec_os_integration">2.5.2. OS (and VMM) integration</h4>
<div class="paragraph">
<p>HFI is designed to require only minimal changes/support from the OS kernel. HFI requires support from OS kernels in two areas:</p>
</div>
<div class="paragraph">
<p><strong>Handling HFI faults</strong>
A fault may occur in HFI mode for to two reasons: (1) normal processor traps such as illegal instructions. (2) HFI policy violations. In both cases, when the processor traps into the kernel, HFI enforcement is disabled so as not to disrupt kernel execution, and the trap is handled through all the normal OS signal mechanisms (This is automatic as HFI hardware checks are only applied to userspace code). When an instruction can trap due to some HFI policy violation, the normal trap mechanism for the current hart is employed. HFI introduces a new trap code, <code>hfi_fault</code> to support this.</p>
</div>
<div class="paragraph">
<p>When an HFI trap occurs, additional details about the cause are stored in the <code>hfifaultstatusreg</code>. A kernel trap handler can immediately read and store this state into the process struct for the current process, so it can be queried by a signal handler. The OS then invokes the standard signal handler registered by the application for memory access violations. The OS must invoke the signal handler with HFI disabled; if the signal handler returns control to the OS, the OS will re-enable HFI prior to resuming the faulting process.</p>
</div>
<div class="paragraph">
<p><strong>Process scheduling</strong>
The kernel must save and restore HFI state (stored in internal registers) when switching between processes/VMs etc. This can be performed using the HFI manipulation instructions <code>hfiresetregions</code>, <code>hfisetregionpermission</code>, <code>hfisetregionsize</code>, <code>hfigetregionsize</code>, etc. To know whether HFI mode is currently enabled by the user space process, more privileged code can check the state of the <code>hfiusermodeenabled</code> status register.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sub_sec_instruction_encoding">2.6. Instruction Encoding</h3>
<div class="paragraph">
<p>HFI base extension introduces a set of functional instructions interacting with specific internal registers. Corresponding to the new internal registers, these instructions primarily fulfill three tasks: HFI mode transition, exit handler configuration, and region manipulation. All of the non-h-prefixed instructions are encoded in a R-type format under the same custom opcode <code>HFUNCTION</code> to achieve maximum flexibility (See <a href="#fig_r_type">Figure 5</a>). The funct 3 field differentiates the instructions based on the tasks, and the funct 7 field further distinguishes the specific instruction. The specific encoding is shown in <a href="#tab_enc_non_h">Table 5</a>. The behavior of these instructions has mostly been covered in <a href="#sec_sbx_setup">todo</a>, <a href="#sec_exit_handler">todo</a> and <a href="#sec_regions">todo</a>, and this section mainly details their encoding.</p>
</div>
<div id="fig_r_type" class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PHN2ZyBvdmVyZmxvdz0iaGlkZGVuIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIyMzEuMjg1NDg5MzEzODM1NzcgMzE5LjY2NTYwMDAwMDAwMDA0IDc5OS4xMDAxMTI0ODU5MzkzIDU3LjYiIHN0eWxlPSJtYXgtaGVpZ2h0OiA1MDBweCIgd2lkdGg9Ijc5OS4xMDAxMTI0ODU5MzkzIiBoZWlnaHQ9IjU3LjYiPjxnPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNzIwIiB3aWR0aD0iMTI4MCIgeT0iMCIgeD0iMCIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjE1MyIgeT0iMzMwIiB4PSIyMzkiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyODguMjg4IDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5mdW5jdDc8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTI4IiB5PSIzMzAiIHg9IjM5MiIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0Mi44MzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJzMjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjgiIHk9IjMzMCIgeD0iNTE5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LjkyMSAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cnMxPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9Ijg4IiB5PSIzMzAiIHg9IjY0NyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2My4zNzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjQiIHk9IjMzMCIgeD0iNzM1Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzg3Ljc4NCAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cmQ8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTYxIiB5PSIzMzAiIHg9Ijg1OSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwOC43MzQgMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm9wY29kZTwvdGV4dD48L2c+PC9zdmc+" alt="r type cropped" width="70%">
</div>
<div class="title">Figure 1. R-type instruction format.</div>
</div>
<div class="paragraph">
<p><strong>HFI Mode Transition Instructions</strong>
These include the <code>hfienter</code> and <code>hfiexit</code> instructions. <code>hfienter&#8217;s 4-bit option vector comes from `rs1</code> and its <code>rd</code> field is invalid. The <code>hfiexit</code> instruction does not have any source or destination register, and thus these fields are all invalid in the instruction.</p>
</div>
<div class="paragraph">
<p><strong>Exit Handler Instructions</strong>
These instructions include <code>hfisetexithandler</code> and <code>hfigetexithandler</code>. They only take one operand from <code>rs1</code> holding the address of the exit handler and configure the handler for sandbox exits and syscalls in the dedicated internal register <code>hfiexithandlerreg</code>.</p>
</div>
<div class="paragraph">
<p><strong>Region Manipulation Instructions</strong>
These include the region-configure instruction <code>hfiselectregion</code>, the region size instructions <code>hfisetregionbase</code>, <code>hfigetregionbase</code>, <code>hfisetregionbound</code>, <code>hfigetregionbound</code>, and the region permissions <code>hfisetregionpermission</code>, <code>hfigetregionpermission</code>, <code>hfiresetregions</code>. All of these instructions directly interact with the corresponding internal registers, which are otherwise inaccessible. <code>hfiselectregion</code>, <code>hfisetregionbase</code>, <code>hfisetregionbound</code> and <code>hfisetregionpermission</code> all take a single operand from <code>rs1</code>, respectively the region number, the base address of the region and the mask for the region. The remaining "get" instructions set the <code>rd</code> register based on these internal registers.</p>
</div>
<table id="tab_enc_non_h" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Encoding for R-type Non-h-prefixed Instructions</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">funct3</th>
<th class="tableblock halign-left valign-top">funct7</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-center valign-top">funct3</th>
<th class="tableblock halign-left valign-top">funct7</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfienter</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfiselectregion</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfiexit</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfisetregionbase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfientertarget</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfigetregionbase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfisetexithandler</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfisetregionpermission</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfigetexithandler</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfigetregionpermission</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfiresetregions</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="sub_sec_pending_considerations">2.7. Pending Design Considerations</h3>
<div class="paragraph">
<p>Here, we include topics that we believe merit further discussion but which we have not fully resolved for inclusion in the specification.</p>
</div>
<div class="sect3">
<h4 id="_streamlining_control_transfers_for_native_binaries">2.7.1. Streamlining Control Transfers for Native Binaries</h4>
<div class="paragraph">
<p>When sandboxing unmodified native binaries, we would ideally like control transfers into and out of the sandbox library to require minimal overhead and complexity. With a few small changes, we could make this simpler than what <code>hfienter</code> and <code>hfiexit</code> offer today.</p>
</div>
<div class="paragraph">
<p>At present, control transfers require redirecting control flow through small stubs (trampolines) that need to be mapped by the sandbox runtime into the sandboxed library address space, this adds complexity and overhead.</p>
</div>
<div class="paragraph">
<p>For example, consider a case where a host application has uses a library sandboxed with HFI; the applications want to invoke a function <code>foo()</code> in the library. To call <code>foo()</code>, it will need trampoline code---application code that performs a context switch by saving the current registers, switching the stack register to point to memory inside a region, enabling HFI and transferring control to <code>foo()</code>. This is mostly straightforward. However, once <code>foo</code> finishes executing (<code>foo</code> executes a return instruction), execution would attempt to return to the trampoline code---an operation that would fail as the trampoline code is not part of the sandbox code. Thus the host application, must perform an intermediate step---it must call <code>foo</code>, while modifying the return address on the stack to point to a stub within the sandbox, which invokes <code>hfiexit</code> and then returns to the trampoline. We could eliminate the need for this stub by dedicating a bit in the return address (e.g. it&#8217;s least significant bit, as this should be unused as instructions are at least 16 bit aligned) on the stack that indicates that if HFI is enabled, this return should simply invoke <code>hfiexit</code>. Similar mechanism could also be applied to eliminating the need for trampolines for direct and indirect calls (i.e. callbacks) to host libraries.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hfi_in_m_mode_or_s_mode">2.7.2. HFI in M-mode or S-mode</h4>
<div class="paragraph">
<p>We plan to add support for HFI in S-mode. Relatively small changes are necessary, however, we have not yet done a full analysis of how privileged instructions are handled. HFI support in m-mode may similarly be possible, but requires additional analysis for hardware implementation details.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec_hfi_explicit">3. Explicit HFI Extension</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Explicit HFI Extension provides hardware support for fine-grained, region-relative addressing. With the Base HFI Extension, which targets unmodified native binaries using absolute virtual addresses, this extension is designed to accelerate SFI runtimes that utilize a linear memory model, such as WebAssembly.</p>
</div>
<div class="paragraph">
<p>In these SFI systems, sandboxed code accesses memory as an offset into a contiguous heap (linear memory) rather than via raw pointers. The Explicit HFI Extension maps this software model directly to hardware: the "heap" becomes an "explicit data region", and software bound-checks are replaced by dedicated <code>h-prefixed</code> instructions. This allows the hardware to enforce precise heap bounds automatically with every memory access, eliminating the performance overhead of software guard instructions.</p>
</div>
<div class="paragraph">
<p>Addressing in this mode is always relative to the base of the currently <em>active region</em> (by default, explicit data region 1), offering efficient control over access to specific buffers or explicit heaps. HFI provides two different region sizes~(<em>large/small</em>), with different granularities. Large regions can address up to 256 TiB (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuNzI1MzEiIGhlaWdodD0iMTAuNTQ4ODI4IiB2aWV3Qm94PSIwIDAgMTYuNzI1MzEgMTAuNTQ4ODI4Ij4KPGRlZnM+CjxnPgo8ZyBpZD0iZ2x5cGgtMC0wIj4KPHBhdGggZD0iTSAwLjczNDM3NSAwIEwgMC43MzQzNzUgLTAuODc1IEwgMi43MzQzNzUgLTMuMTg3NSBDIDMuMTYwMTU2IC0zLjY4NzUgMy40OTIxODggLTQuMTE3MTg4IDMuNzM0Mzc1IC00LjQ4NDM3NSBDIDMuOTg0Mzc1IC00Ljg0NzY1NiA0LjE2MDE1NiAtNS4xOTE0MDYgNC4yNjU2MjUgLTUuNTE1NjI1IEMgNC4zNzg5MDYgLTUuODQ3NjU2IDQuNDM3NSAtNi4xOTUzMTIgNC40Mzc1IC02LjU2MjUgQyA0LjQzNzUgLTcuMDE5NTMxIDQuMzM1OTM4IC03LjM5MDYyNSA0LjE0MDYyNSAtNy42NzE4NzUgQyAzLjk1MzEyNSAtNy45NTMxMjUgMy42NDQ1MzEgLTguMDkzNzUgMy4yMTg3NSAtOC4wOTM3NSBDIDIuODUxNTYyIC04LjA5Mzc1IDIuNTcwMzEyIC04LjAwMzkwNiAyLjM3NSAtNy44MjgxMjUgQyAyLjE4NzUgLTcuNjYwMTU2IDIuMDU0Njg4IC03LjQ0MTQwNiAxLjk4NDM3NSAtNy4xNzE4NzUgQyAxLjkyMTg3NSAtNi45MTAxNTYgMS44OTA2MjUgLTYuNjE3MTg4IDEuODkwNjI1IC02LjI5Njg3NSBDIDEuNjA5Mzc1IC02LjI5Njg3NSAxLjM2MzI4MSAtNi4zNDc2NTYgMS4xNTYyNSAtNi40NTMxMjUgQyAwLjk1NzAzMSAtNi41NjY0MDYgMC44NTkzNzUgLTYuNzczNDM4IDAuODU5Mzc1IC03LjA3ODEyNSBDIDAuODU5Mzc1IC03LjU0Njg3NSAxLjA1NDY4OCAtNy45Mjk2ODggMS40NTMxMjUgLTguMjM0Mzc1IEMgMS44NDc2NTYgLTguNTM1MTU2IDIuNDM3NSAtOC42ODc1IDMuMjE4NzUgLTguNjg3NSBDIDMuOTc2NTYyIC04LjY4NzUgNC41NzAzMTIgLTguNTAzOTA2IDUgLTguMTQwNjI1IEMgNS40Mzc1IC03Ljc3MzQzOCA1LjY1NjI1IC03LjI4OTA2MiA1LjY1NjI1IC02LjY4NzUgQyA1LjY1NjI1IC02LjEyNSA1LjQ3NjU2MiAtNS41NzgxMjUgNS4xMjUgLTUuMDQ2ODc1IEMgNC43Njk1MzEgLTQuNTE1NjI1IDQuMjczNDM4IC0zLjg5ODQzOCAzLjY0MDYyNSAtMy4yMDMxMjUgTCAxLjYyNSAtMC45NTMxMjUgTCA0LjM5MDYyNSAtMC45NTMxMjUgQyA0Ljc1MzkwNiAtMC45NTMxMjUgNSAtMS4wNDY4NzUgNS4xMjUgLTEuMjM0Mzc1IEMgNS4yNSAtMS40MjE4NzUgNS4zNDM3NSAtMS42Mjg5MDYgNS40MDYyNSAtMS44NTkzNzUgTCA1LjQ1MzEyNSAtMi4wNzgxMjUgTCA1Ljk1MzEyNSAtMi4wNzgxMjUgTCA1Ljg5MDYyNSAwIFogTSAwLjczNDM3NSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTAiPgo8cGF0aCBkPSJNIDEuODI4MTI1IDAgTCAxLjgyODEyNSAtMC4zNTkzNzUgTCAyLjA2MjUgLTAuMzU5Mzc1IEMgMi4yNTc4MTIgLTAuMzU5Mzc1IDIuNDI1NzgxIC0wLjM5NDUzMSAyLjU2MjUgLTAuNDY4NzUgQyAyLjY5NTMxMiAtMC41MzkwNjIgMi43NjU2MjUgLTAuNzA3MDMxIDIuNzY1NjI1IC0wLjk2ODc1IEwgMi43NjU2MjUgLTEuNjcxODc1IEwgMC4xNDA2MjUgLTEuNjcxODc1IEwgMC4xNDA2MjUgLTIuMDE1NjI1IEwgMi43ODEyNSAtNi4wNzgxMjUgTCAzLjU3ODEyNSAtNi4wNzgxMjUgTCAzLjU3ODEyNSAtMi4xNDA2MjUgTCA0LjY0MDYyNSAtMi4xNDA2MjUgTCA0LjY0MDYyNSAtMS42NzE4NzUgTCAzLjU3ODEyNSAtMS42NzE4NzUgTCAzLjU3ODEyNSAtMC45Njg3NSBDIDMuNTc4MTI1IC0wLjcwNzAzMSAzLjY0NDUzMSAtMC41MzkwNjIgMy43ODEyNSAtMC40Njg3NSBDIDMuOTI1NzgxIC0wLjM5NDUzMSA0LjA5Mzc1IC0wLjM1OTM3NSA0LjI4MTI1IC0wLjM1OTM3NSBMIDQuMzkwNjI1IC0wLjM1OTM3NSBMIDQuMzkwNjI1IDAgWiBNIDAuNzY1NjI1IC0yLjE0MDYyNSBMIDIuNzY1NjI1IC0yLjE0MDYyNSBMIDIuNzY1NjI1IC0zLjcxODc1IEMgMi43NjU2MjUgLTMuODgyODEyIDIuNzY1NjI1IC00LjA3MDMxMiAyLjc2NTYyNSAtNC4yODEyNSBDIDIuNzczNDM4IC00LjQ4ODI4MSAyLjc4NTE1NiAtNC42OTUzMTIgMi43OTY4NzUgLTQuOTA2MjUgQyAyLjgwNDY4OCAtNS4xMTMyODEgMi44MTY0MDYgLTUuMzA0Njg4IDIuODI4MTI1IC01LjQ4NDM3NSBDIDIuNzk2ODc1IC01LjQyOTY4OCAyLjc1IC01LjM0NzY1NiAyLjY4NzUgLTUuMjM0Mzc1IEMgMi42MjUgLTUuMTE3MTg4IDIuNTUwNzgxIC00Ljk5MjE4OCAyLjQ2ODc1IC00Ljg1OTM3NSBDIDIuMzk0NTMxIC00LjcyMjY1NiAyLjMyMDMxMiAtNC41OTM3NSAyLjI1IC00LjQ2ODc1IEMgMi4xNzU3ODEgLTQuMzUxNTYyIDIuMTEzMjgxIC00LjI1MzkwNiAyLjA2MjUgLTQuMTcxODc1IFogTSAwLjc2NTYyNSAtMi4xNDA2MjUgIi8+CjwvZz4KPGcgaWQ9ImdseXBoLTEtMSI+CjxwYXRoIGQ9Ik0gMi4zMjgxMjUgMC4wNzgxMjUgQyAxLjg5ODQzOCAwLjA3ODEyNSAxLjUzOTA2MiAwLjAwNzgxMjUgMS4yNSAtMC4xMjUgQyAwLjk2ODc1IC0wLjI2OTUzMSAwLjc1MzkwNiAtMC40NjA5MzggMC42MDkzNzUgLTAuNzAzMTI1IEMgMC40NjA5MzggLTAuOTUzMTI1IDAuMzkwNjI1IC0xLjIyNjU2MiAwLjM5MDYyNSAtMS41MzEyNSBDIDAuMzkwNjI1IC0xLjgwMDc4MSAwLjQ0NTMxMiAtMi4wMzEyNSAwLjU2MjUgLTIuMjE4NzUgQyAwLjY3NTc4MSAtMi40MDYyNSAwLjgyODEyNSAtMi41NjY0MDYgMS4wMTU2MjUgLTIuNzAzMTI1IEMgMS4yMTA5MzggLTIuODM1OTM4IDEuNDM3NSAtMi45NjA5MzggMS42ODc1IC0zLjA3ODEyNSBDIDEuMzYzMjgxIC0zLjI2NTYyNSAxLjA5NzY1NiAtMy40ODQzNzUgMC44OTA2MjUgLTMuNzM0Mzc1IEMgMC42OTE0MDYgLTMuOTg0Mzc1IDAuNTkzNzUgLTQuMjg1MTU2IDAuNTkzNzUgLTQuNjQwNjI1IEMgMC41OTM3NSAtNC44OTg0MzggMC42NTYyNSAtNS4xNDQ1MzEgMC43ODEyNSAtNS4zNzUgQyAwLjkwNjI1IC01LjYxMzI4MSAxLjA5NzY1NiAtNS44MDQ2ODggMS4zNTkzNzUgLTUuOTUzMTI1IEMgMS42Mjg5MDYgLTYuMDk3NjU2IDEuOTg0Mzc1IC02LjE3MTg3NSAyLjQyMTg3NSAtNi4xNzE4NzUgQyAyLjk2MDkzOCAtNi4xNzE4NzUgMy4zNzg5MDYgLTYuMDMxMjUgMy42NzE4NzUgLTUuNzUgQyAzLjk2MDkzOCAtNS40NzY1NjIgNC4xMDkzNzUgLTUuMTI4OTA2IDQuMTA5Mzc1IC00LjcwMzEyNSBDIDQuMTA5Mzc1IC00LjMyODEyNSA0IC00LjAzNTE1NiAzLjc4MTI1IC0zLjgyODEyNSBDIDMuNTcwMzEyIC0zLjYxNzE4OCAzLjI5Njg3NSAtMy40Mjk2ODggMi45NTMxMjUgLTMuMjY1NjI1IEMgMy4zNjcxODggLTMuMDY2NDA2IDMuNzA3MDMxIC0yLjgzNTkzOCAzLjk2ODc1IC0yLjU3ODEyNSBDIDQuMjM4MjgxIC0yLjMxNjQwNiA0LjM3NSAtMiA0LjM3NSAtMS42MjUgQyA0LjM3NSAtMS4wODIwMzEgNC4xODc1IC0wLjY2MDE1NiAzLjgxMjUgLTAuMzU5Mzc1IEMgMy40NDUzMTIgLTAuMDY2NDA2MiAyLjk1MzEyNSAwLjA3ODEyNSAyLjMyODEyNSAwLjA3ODEyNSBaIE0gMi41MzEyNSAtMy40NTMxMjUgQyAyLjg1MTU2MiAtMy42MTcxODggMy4wNjY0MDYgLTMuNzk2ODc1IDMuMTcxODc1IC0zLjk4NDM3NSBDIDMuMjg1MTU2IC00LjE3OTY4OCAzLjM0Mzc1IC00LjQyNTc4MSAzLjM0Mzc1IC00LjcxODc1IEMgMy4zNDM3NSAtNC44OTQ1MzEgMy4zMTI1IC01LjA2MjUgMy4yNSAtNS4yMTg3NSBDIDMuMTg3NSAtNS4zNzUgMy4wODIwMzEgLTUuNTAzOTA2IDIuOTM3NSAtNS42MDkzNzUgQyAyLjgwMDc4MSAtNS43MTA5MzggMi42MTMyODEgLTUuNzY1NjI1IDIuMzc1IC01Ljc2NTYyNSBDIDIuMDYyNSAtNS43NjU2MjUgMS44MTY0MDYgLTUuNjY0MDYyIDEuNjQwNjI1IC01LjQ2ODc1IEMgMS40NzI2NTYgLTUuMjgxMjUgMS4zOTA2MjUgLTUuMDM5MDYyIDEuMzkwNjI1IC00Ljc1IEMgMS4zOTA2MjUgLTQuNDM3NSAxLjQ4NDM3NSAtNC4xODc1IDEuNjcxODc1IC00IEMgMS44NjcxODggLTMuODEyNSAyLjE1NjI1IC0zLjYyODkwNiAyLjUzMTI1IC0zLjQ1MzEyNSBaIE0gMi4zNzUgLTAuMzEyNSBDIDIuNzM4MjgxIC0wLjMxMjUgMy4wMzEyNSAtMC40MTQwNjIgMy4yNSAtMC42MjUgQyAzLjQ3NjU2MiAtMC44MzIwMzEgMy41OTM3NSAtMS4xMDE1NjIgMy41OTM3NSAtMS40Mzc1IEMgMy41OTM3NSAtMS43MjY1NjIgMy40NzY1NjIgLTEuOTc2NTYyIDMuMjUgLTIuMTg3NSBDIDMuMDMxMjUgLTIuNDA2MjUgMi42NDQ1MzEgLTIuNjMyODEyIDIuMDkzNzUgLTIuODc1IEMgMS44MjAzMTIgLTIuNzM4MjgxIDEuNjA5Mzc1IC0yLjU1MDc4MSAxLjQ1MzEyNSAtMi4zMTI1IEMgMS4yOTY4NzUgLTIuMDgyMDMxIDEuMjE4NzUgLTEuODA0Njg4IDEuMjE4NzUgLTEuNDg0Mzc1IEMgMS4yMTg3NSAtMS4xNDA2MjUgMS4zMTI1IC0wLjg1OTM3NSAxLjUgLTAuNjQwNjI1IEMgMS42OTUzMTIgLTAuNDIxODc1IDEuOTg4MjgxIC0wLjMxMjUgMi4zNzUgLTAuMzEyNSBaIE0gMi4zNzUgLTAuMzEyNSAiLz4KPC9nPgo8L2c+CjwvZGVmcz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0wLTAiIHg9Ii0wLjA2NjQwNjIiIHk9IjEwLjU0Njg3NSIvPgo8L2c+CjxnIGZpbGw9InJnYigwJSwgMCUsIDAlKSIgZmlsbC1vcGFjaXR5PSIxIj4KPHVzZSB4bGluazpocmVmPSIjZ2x5cGgtMS0wIiB4PSI2Ljg4MjgxMiIgeT0iNi4xNjk5MjIiLz4KPHVzZSB4bGluazpocmVmPSIjZ2x5cGgtMS0xIiB4PSIxMS44ODI4MTIiIHk9IjYuMTY5OTIyIi8+CjwvZz4KPC9zdmc+Cg==" alt="stem 3d25890e9a3b06914918d4b71e33e8c5" width="16" height="10"></span>) and are sized and aligned to multiples of 64K (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuMjY1MzQ5IiBoZWlnaHQ9IjEwLjU0ODgyOCIgdmlld0JveD0iMCAwIDE2LjI2NTM0OSAxMC41NDg4MjgiPgo8ZGVmcz4KPGc+CjxnIGlkPSJnbHlwaC0wLTAiPgo8cGF0aCBkPSJNIDAuNzM0Mzc1IDAgTCAwLjczNDM3NSAtMC44NzUgTCAyLjczNDM3NSAtMy4xODc1IEMgMy4xNjAxNTYgLTMuNjg3NSAzLjQ5MjE4OCAtNC4xMTcxODggMy43MzQzNzUgLTQuNDg0Mzc1IEMgMy45ODQzNzUgLTQuODQ3NjU2IDQuMTYwMTU2IC01LjE5MTQwNiA0LjI2NTYyNSAtNS41MTU2MjUgQyA0LjM3ODkwNiAtNS44NDc2NTYgNC40Mzc1IC02LjE5NTMxMiA0LjQzNzUgLTYuNTYyNSBDIDQuNDM3NSAtNy4wMTk1MzEgNC4zMzU5MzggLTcuMzkwNjI1IDQuMTQwNjI1IC03LjY3MTg3NSBDIDMuOTUzMTI1IC03Ljk1MzEyNSAzLjY0NDUzMSAtOC4wOTM3NSAzLjIxODc1IC04LjA5Mzc1IEMgMi44NTE1NjIgLTguMDkzNzUgMi41NzAzMTIgLTguMDAzOTA2IDIuMzc1IC03LjgyODEyNSBDIDIuMTg3NSAtNy42NjAxNTYgMi4wNTQ2ODggLTcuNDQxNDA2IDEuOTg0Mzc1IC03LjE3MTg3NSBDIDEuOTIxODc1IC02LjkxMDE1NiAxLjg5MDYyNSAtNi42MTcxODggMS44OTA2MjUgLTYuMjk2ODc1IEMgMS42MDkzNzUgLTYuMjk2ODc1IDEuMzYzMjgxIC02LjM0NzY1NiAxLjE1NjI1IC02LjQ1MzEyNSBDIDAuOTU3MDMxIC02LjU2NjQwNiAwLjg1OTM3NSAtNi43NzM0MzggMC44NTkzNzUgLTcuMDc4MTI1IEMgMC44NTkzNzUgLTcuNTQ2ODc1IDEuMDU0Njg4IC03LjkyOTY4OCAxLjQ1MzEyNSAtOC4yMzQzNzUgQyAxLjg0NzY1NiAtOC41MzUxNTYgMi40Mzc1IC04LjY4NzUgMy4yMTg3NSAtOC42ODc1IEMgMy45NzY1NjIgLTguNjg3NSA0LjU3MDMxMiAtOC41MDM5MDYgNSAtOC4xNDA2MjUgQyA1LjQzNzUgLTcuNzczNDM4IDUuNjU2MjUgLTcuMjg5MDYyIDUuNjU2MjUgLTYuNjg3NSBDIDUuNjU2MjUgLTYuMTI1IDUuNDc2NTYyIC01LjU3ODEyNSA1LjEyNSAtNS4wNDY4NzUgQyA0Ljc2OTUzMSAtNC41MTU2MjUgNC4yNzM0MzggLTMuODk4NDM4IDMuNjQwNjI1IC0zLjIwMzEyNSBMIDEuNjI1IC0wLjk1MzEyNSBMIDQuMzkwNjI1IC0wLjk1MzEyNSBDIDQuNzUzOTA2IC0wLjk1MzEyNSA1IC0xLjA0Njg3NSA1LjEyNSAtMS4yMzQzNzUgQyA1LjI1IC0xLjQyMTg3NSA1LjM0Mzc1IC0xLjYyODkwNiA1LjQwNjI1IC0xLjg1OTM3NSBMIDUuNDUzMTI1IC0yLjA3ODEyNSBMIDUuOTUzMTI1IC0yLjA3ODEyNSBMIDUuODkwNjI1IDAgWiBNIDAuNzM0Mzc1IDAgIi8+CjwvZz4KPGcgaWQ9ImdseXBoLTEtMCI+CjxwYXRoIGQ9Ik0gMC44MTI1IDAgTCAwLjgxMjUgLTAuMzU5Mzc1IEwgMS4zOTA2MjUgLTAuMzU5Mzc1IEMgMS41NzgxMjUgLTAuMzU5Mzc1IDEuNzM4MjgxIC0wLjM5NDUzMSAxLjg3NSAtMC40Njg3NSBDIDIuMDE5NTMxIC0wLjUzOTA2MiAyLjA5Mzc1IC0wLjcwNzAzMSAyLjA5Mzc1IC0wLjk2ODc1IEwgMi4wOTM3NSAtNS40Mzc1IEMgMS44NzUgLTUuMTc1NzgxIDEuNjc1NzgxIC00Ljk2MDkzOCAxLjUgLTQuNzk2ODc1IEMgMS4zMzIwMzEgLTQuNjQwNjI1IDEuMTYwMTU2IC00LjU2MjUgMC45ODQzNzUgLTQuNTYyNSBDIDAuODU5Mzc1IC00LjU2MjUgMC43NTM5MDYgLTQuNjAxNTYyIDAuNjcxODc1IC00LjY4NzUgQyAwLjU5NzY1NiAtNC43Njk1MzEgMC41NjI1IC00Ljg3ODkwNiAwLjU2MjUgLTUuMDE1NjI1IEMgMC43MjY1NjIgLTUuMDU0Njg4IDAuOTA2MjUgLTUuMTI1IDEuMDkzNzUgLTUuMjE4NzUgQyAxLjI4OTA2MiAtNS4zMTI1IDEuNTMxMjUgLTUuNDYwOTM4IDEuODEyNSAtNS42NzE4NzUgTCAyLjQwNjI1IC02LjEwOTM3NSBMIDIuOTUzMTI1IC02LjEwOTM3NSBMIDIuOTUzMTI1IC0wLjk2ODc1IEMgMi45NTMxMjUgLTAuNzA3MDMxIDMuMDE5NTMxIC0wLjUzOTA2MiAzLjE1NjI1IC0wLjQ2ODc1IEMgMy4yODkwNjIgLTAuMzk0NTMxIDMuNDUzMTI1IC0wLjM1OTM3NSAzLjY0MDYyNSAtMC4zNTkzNzUgTCA0LjA2MjUgLTAuMzU5Mzc1IEwgNC4wNjI1IDAgWiBNIDAuODEyNSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTEiPgo8cGF0aCBkPSJNIDIuNSAwLjA3ODEyNSBDIDIuMTI1IDAuMDc4MTI1IDEuNzg1MTU2IC0wLjAyMzQzNzUgMS40ODQzNzUgLTAuMjM0Mzc1IEMgMS4xNzk2ODggLTAuNDQxNDA2IDAuOTQxNDA2IC0wLjc3MzQzOCAwLjc2NTYyNSAtMS4yMzQzNzUgQyAwLjU5NzY1NiAtMS43MDMxMjUgMC41MTU2MjUgLTIuMzEyNSAwLjUxNTYyNSAtMy4wNjI1IEMgMC41MTU2MjUgLTMuNDY4NzUgMC41NjI1IC0zLjg1MTU2MiAwLjY1NjI1IC00LjIxODc1IEMgMC43NSAtNC41OTM3NSAwLjg4MjgxMiAtNC45MjU3ODEgMS4wNjI1IC01LjIxODc1IEMgMS4yNSAtNS41MDc4MTIgMS40ODQzNzUgLTUuNzM4MjgxIDEuNzY1NjI1IC01LjkwNjI1IEMgMi4wNDY4NzUgLTYuMDgyMDMxIDIuMzY3MTg4IC02LjE3MTg3NSAyLjczNDM3NSAtNi4xNzE4NzUgQyAzLjIxMDkzOCAtNi4xNzE4NzUgMy41NjY0MDYgLTYuMDc4MTI1IDMuNzk2ODc1IC01Ljg5MDYyNSBDIDQuMDIzNDM4IC01LjcxMDkzOCA0LjE0MDYyNSAtNS41MDM5MDYgNC4xNDA2MjUgLTUuMjY1NjI1IEMgNC4xNDA2MjUgLTQuOTI5Njg4IDMuOTIxODc1IC00Ljc2NTYyNSAzLjQ4NDM3NSAtNC43NjU2MjUgQyAzLjQ4NDM3NSAtNS4wMzUxNTYgMy40MjU3ODEgLTUuMjY1NjI1IDMuMzEyNSAtNS40NTMxMjUgQyAzLjIwNzAzMSAtNS42NDg0MzggMy4wMTU2MjUgLTUuNzUgMi43MzQzNzUgLTUuNzUgQyAyLjMxNjQwNiAtNS43NSAxLjk5MjE4OCAtNS41MzUxNTYgMS43NjU2MjUgLTUuMTA5Mzc1IEMgMS41NDY4NzUgLTQuNjkxNDA2IDEuNDIxODc1IC00LjA3MDMxMiAxLjM5MDYyNSAtMy4yNSBDIDEuNTM1MTU2IC0zLjM2MzI4MSAxLjcwNzAzMSAtMy40Njg3NSAxLjkwNjI1IC0zLjU2MjUgQyAyLjEwMTU2MiAtMy42NTYyNSAyLjMzNTkzOCAtMy43MDMxMjUgMi42MDkzNzUgLTMuNzAzMTI1IEMgMy4xMjg5MDYgLTMuNzAzMTI1IDMuNTQ2ODc1IC0zLjU0Njg3NSAzLjg1OTM3NSAtMy4yMzQzNzUgQyA0LjE3MTg3NSAtMi45MjE4NzUgNC4zMjgxMjUgLTIuNDkyMTg4IDQuMzI4MTI1IC0xLjk1MzEyNSBDIDQuMzI4MTI1IC0xLjU1NDY4OCA0LjI1MzkwNiAtMS4yMDMxMjUgNC4xMDkzNzUgLTAuODkwNjI1IEMgMy45NjA5MzggLTAuNTg1OTM4IDMuNzUzOTA2IC0wLjM0NzY1NiAzLjQ4NDM3NSAtMC4xNzE4NzUgQyAzLjIxMDkzOCAtMC4wMDM5MDYyNSAyLjg4MjgxMiAwLjA3ODEyNSAyLjUgMC4wNzgxMjUgWiBNIDIuNTE1NjI1IC0wLjM5MDYyNSBDIDIuODE2NDA2IC0wLjM5MDYyNSAzLjA0Njg3NSAtMC41MDM5MDYgMy4yMDMxMjUgLTAuNzM0Mzc1IEMgMy4zNjcxODggLTAuOTcyNjU2IDMuNDUzMTI1IC0xLjM0NzY1NiAzLjQ1MzEyNSAtMS44NTkzNzUgQyAzLjQ1MzEyNSAtMi4zNDc2NTYgMy4zNjMyODEgLTIuNzAzMTI1IDMuMTg3NSAtMi45MjE4NzUgQyAzLjAxOTUzMSAtMy4xNDg0MzggMi43Njk1MzEgLTMuMjY1NjI1IDIuNDM3NSAtMy4yNjU2MjUgQyAyLjIxODc1IC0zLjI2NTYyNSAyLjAxNTYyNSAtMy4yMTA5MzggMS44MjgxMjUgLTMuMTA5Mzc1IEMgMS42NDg0MzggLTMuMDAzOTA2IDEuNTAzOTA2IC0yLjg5MDYyNSAxLjM5MDYyNSAtMi43NjU2MjUgQyAxLjM5ODQzOCAtMS45MTAxNTYgMS41MDM5MDYgLTEuMzAwNzgxIDEuNzAzMTI1IC0wLjkzNzUgQyAxLjkxMDE1NiAtMC41NzAzMTIgMi4xNzk2ODggLTAuMzkwNjI1IDIuNTE1NjI1IC0wLjM5MDYyNSBaIE0gMi41MTU2MjUgLTAuMzkwNjI1ICIvPgo8L2c+CjwvZz4KPC9kZWZzPgo8ZyBmaWxsPSJyZ2IoMCUsIDAlLCAwJSkiIGZpbGwtb3BhY2l0eT0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTAtMCIgeD0iLTAuMDY2NDA2MiIgeT0iMTAuNTQ2ODc1Ii8+CjwvZz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTAiIHg9IjYuNDY0ODQ0IiB5PSI2LjE2OTkyMiIvPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTEiIHg9IjExLjQ2NDg0NCIgeT0iNi4xNjk5MjIiLz4KPC9nPgo8L3N2Zz4K" alt="stem e4da6f057edacac14e5878a7774ba26c" width="16" height="10"></span>). Small regions, in contrast, can only address up to 4GiB (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuMjMxMTciIGhlaWdodD0iMTAuNTQ4ODI4IiB2aWV3Qm94PSIwIDAgMTYuMjMxMTcgMTAuNTQ4ODI4Ij4KPGRlZnM+CjxnPgo8ZyBpZD0iZ2x5cGgtMC0wIj4KPHBhdGggZD0iTSAwLjczNDM3NSAwIEwgMC43MzQzNzUgLTAuODc1IEwgMi43MzQzNzUgLTMuMTg3NSBDIDMuMTYwMTU2IC0zLjY4NzUgMy40OTIxODggLTQuMTE3MTg4IDMuNzM0Mzc1IC00LjQ4NDM3NSBDIDMuOTg0Mzc1IC00Ljg0NzY1NiA0LjE2MDE1NiAtNS4xOTE0MDYgNC4yNjU2MjUgLTUuNTE1NjI1IEMgNC4zNzg5MDYgLTUuODQ3NjU2IDQuNDM3NSAtNi4xOTUzMTIgNC40Mzc1IC02LjU2MjUgQyA0LjQzNzUgLTcuMDE5NTMxIDQuMzM1OTM4IC03LjM5MDYyNSA0LjE0MDYyNSAtNy42NzE4NzUgQyAzLjk1MzEyNSAtNy45NTMxMjUgMy42NDQ1MzEgLTguMDkzNzUgMy4yMTg3NSAtOC4wOTM3NSBDIDIuODUxNTYyIC04LjA5Mzc1IDIuNTcwMzEyIC04LjAwMzkwNiAyLjM3NSAtNy44MjgxMjUgQyAyLjE4NzUgLTcuNjYwMTU2IDIuMDU0Njg4IC03LjQ0MTQwNiAxLjk4NDM3NSAtNy4xNzE4NzUgQyAxLjkyMTg3NSAtNi45MTAxNTYgMS44OTA2MjUgLTYuNjE3MTg4IDEuODkwNjI1IC02LjI5Njg3NSBDIDEuNjA5Mzc1IC02LjI5Njg3NSAxLjM2MzI4MSAtNi4zNDc2NTYgMS4xNTYyNSAtNi40NTMxMjUgQyAwLjk1NzAzMSAtNi41NjY0MDYgMC44NTkzNzUgLTYuNzczNDM4IDAuODU5Mzc1IC03LjA3ODEyNSBDIDAuODU5Mzc1IC03LjU0Njg3NSAxLjA1NDY4OCAtNy45Mjk2ODggMS40NTMxMjUgLTguMjM0Mzc1IEMgMS44NDc2NTYgLTguNTM1MTU2IDIuNDM3NSAtOC42ODc1IDMuMjE4NzUgLTguNjg3NSBDIDMuOTc2NTYyIC04LjY4NzUgNC41NzAzMTIgLTguNTAzOTA2IDUgLTguMTQwNjI1IEMgNS40Mzc1IC03Ljc3MzQzOCA1LjY1NjI1IC03LjI4OTA2MiA1LjY1NjI1IC02LjY4NzUgQyA1LjY1NjI1IC02LjEyNSA1LjQ3NjU2MiAtNS41NzgxMjUgNS4xMjUgLTUuMDQ2ODc1IEMgNC43Njk1MzEgLTQuNTE1NjI1IDQuMjczNDM4IC0zLjg5ODQzOCAzLjY0MDYyNSAtMy4yMDMxMjUgTCAxLjYyNSAtMC45NTMxMjUgTCA0LjM5MDYyNSAtMC45NTMxMjUgQyA0Ljc1MzkwNiAtMC45NTMxMjUgNSAtMS4wNDY4NzUgNS4xMjUgLTEuMjM0Mzc1IEMgNS4yNSAtMS40MjE4NzUgNS4zNDM3NSAtMS42Mjg5MDYgNS40MDYyNSAtMS44NTkzNzUgTCA1LjQ1MzEyNSAtMi4wNzgxMjUgTCA1Ljk1MzEyNSAtMi4wNzgxMjUgTCA1Ljg5MDYyNSAwIFogTSAwLjczNDM3NSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTAiPgo8cGF0aCBkPSJNIDIuMTA5Mzc1IDAuMDc4MTI1IEMgMS41NDY4NzUgMC4wNzgxMjUgMS4xMzI4MTIgLTAuMDE1NjI1IDAuODc1IC0wLjIwMzEyNSBDIDAuNjI1IC0wLjM5MDYyNSAwLjUgLTAuNjA5Mzc1IDAuNSAtMC44NTkzNzUgQyAwLjUgLTEuMDIzNDM4IDAuNTQ2ODc1IC0xLjE1NjI1IDAuNjQwNjI1IC0xLjI1IEMgMC43NDIxODggLTEuMzUxNTYyIDAuODc1IC0xLjQwNjI1IDEuMDMxMjUgLTEuNDA2MjUgQyAxLjAzMTI1IC0xLjExMzI4MSAxLjEyNSAtMC44NjcxODggMS4zMTI1IC0wLjY3MTg3NSBDIDEuNSAtMC40NzI2NTYgMS43NjU2MjUgLTAuMzc1IDIuMTA5Mzc1IC0wLjM3NSBDIDIuMzM1OTM4IC0wLjM3NSAyLjU0Njg3NSAtMC40MTQwNjIgMi43MzQzNzUgLTAuNSBDIDIuOTIxODc1IC0wLjU5Mzc1IDMuMDcwMzEyIC0wLjczODI4MSAzLjE4NzUgLTAuOTM3NSBDIDMuMzEyNSAtMS4xMzI4MTIgMy4zNzUgLTEuNDA2MjUgMy4zNzUgLTEuNzUgQyAzLjM3NSAtMi4xMDE1NjIgMy4yMzQzNzUgLTIuMzgyODEyIDIuOTUzMTI1IC0yLjU5Mzc1IEMgMi42Nzk2ODggLTIuODEyNSAyLjMxMjUgLTIuOTIxODc1IDEuODQzNzUgLTIuOTIxODc1IEwgMS41NjI1IC0yLjkyMTg3NSBMIDEuNTYyNSAtMy4zNTkzNzUgTCAxLjg0Mzc1IC0zLjM1OTM3NSBDIDIuMDkzNzUgLTMuMzU5Mzc1IDIuMzE2NDA2IC0zLjQxMDE1NiAyLjUxNTYyNSAtMy41MTU2MjUgQyAyLjcxMDkzOCAtMy42Mjg5MDYgMi44NjcxODggLTMuNzg1MTU2IDIuOTg0Mzc1IC0zLjk4NDM3NSBDIDMuMTA5Mzc1IC00LjE3OTY4OCAzLjE3MTg3NSAtNC40MTQwNjIgMy4xNzE4NzUgLTQuNjg3NSBDIDMuMTcxODc1IC01LjAxOTUzMSAzLjEwMTU2MiAtNS4yNzM0MzggMi45Njg3NSAtNS40NTMxMjUgQyAyLjgzMjAzMSAtNS42NDA2MjUgMi41OTc2NTYgLTUuNzM0Mzc1IDIuMjY1NjI1IC01LjczNDM3NSBDIDIuMDAzOTA2IC01LjczNDM3NSAxLjgwNDY4OCAtNS42NzE4NzUgMS42NzE4NzUgLTUuNTQ2ODc1IEMgMS41MzUxNTYgLTUuNDI5Njg4IDEuNDQxNDA2IC01LjI4MTI1IDEuMzkwNjI1IC01LjA5Mzc1IEMgMS4zNDc2NTYgLTQuOTA2MjUgMS4zMjgxMjUgLTQuNjk1MzEyIDEuMzI4MTI1IC00LjQ2ODc1IEMgMS4xMTcxODggLTQuNDY4NzUgMC45NDE0MDYgLTQuNTAzOTA2IDAuNzk2ODc1IC00LjU3ODEyNSBDIDAuNjYwMTU2IC00LjY2MDE1NiAwLjU5Mzc1IC00LjgxMjUgMC41OTM3NSAtNS4wMzEyNSBDIDAuNTkzNzUgLTUuMzUxNTYyIDAuNzM0Mzc1IC01LjYyNSAxLjAxNTYyNSAtNS44NDM3NSBDIDEuMjk2ODc1IC02LjA2MjUgMS43MTA5MzggLTYuMTcxODc1IDIuMjY1NjI1IC02LjE3MTg3NSBDIDIuODA0Njg4IC02LjE3MTg3NSAzLjIzODI4MSAtNi4wNTA3ODEgMy41NjI1IC01LjgxMjUgQyAzLjg4MjgxMiAtNS41NzAzMTIgNC4wNDY4NzUgLTUuMjM4MjgxIDQuMDQ2ODc1IC00LjgxMjUgQyA0LjA0Njg3NSAtNC41NTA3ODEgMy45ODgyODEgLTQuMzE2NDA2IDMuODc1IC00LjEwOTM3NSBDIDMuNzU3ODEyIC0zLjg5ODQzOCAzLjU5NzY1NiAtMy43MTg3NSAzLjM5MDYyNSAtMy41NjI1IEMgMy4xNzk2ODggLTMuNDE0MDYyIDIuOTQ1MzEyIC0zLjMxMjUgMi42ODc1IC0zLjI1IEMgMi44NDM3NSAtMy4yMjY1NjIgMy4wMDc4MTIgLTMuMTkxNDA2IDMuMTg3NSAtMy4xNDA2MjUgQyAzLjM3NSAtMy4wODU5MzggMy41NDY4NzUgLTMuMDAzOTA2IDMuNzAzMTI1IC0yLjg5MDYyNSBDIDMuODY3MTg4IC0yLjc3MzQzOCA0LjAwMzkwNiAtMi42MjUgNC4xMDkzNzUgLTIuNDM3NSBDIDQuMjEwOTM4IC0yLjI1IDQuMjY1NjI1IC0yLjAxNTYyNSA0LjI2NTYyNSAtMS43MzQzNzUgQyA0LjI2NTYyNSAtMS4zOTA2MjUgNC4xOTUzMTIgLTEuMDk3NjU2IDQuMDYyNSAtMC44NTkzNzUgQyAzLjkzNzUgLTAuNjI4OTA2IDMuNzY1NjI1IC0wLjQ0NTMxMiAzLjU0Njg3NSAtMC4zMTI1IEMgMy4zMzU5MzggLTAuMTc1NzgxIDMuMTAxNTYyIC0wLjA3ODEyNSAyLjg0Mzc1IC0wLjAxNTYyNSBDIDIuNTkzNzUgMC4wNDY4NzUgMi4zNDc2NTYgMC4wNzgxMjUgMi4xMDkzNzUgMC4wNzgxMjUgWiBNIDIuMTA5Mzc1IDAuMDc4MTI1ICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTEiPgo8cGF0aCBkPSJNIDAuNTE1NjI1IDAgTCAwLjUxNTYyNSAtMC42MjUgTCAxLjkzNzUgLTIuMjY1NjI1IEMgMi4yMzgyODEgLTIuNjE3MTg4IDIuNDc2NTYyIC0yLjkyMTg3NSAyLjY1NjI1IC0zLjE3MTg3NSBDIDIuODMyMDMxIC0zLjQyOTY4OCAyLjk1NzAzMSAtMy42NzU3ODEgMy4wMzEyNSAtMy45MDYyNSBDIDMuMTEzMjgxIC00LjE0NDUzMSAzLjE1NjI1IC00LjM5NDUzMSAzLjE1NjI1IC00LjY1NjI1IEMgMy4xNTYyNSAtNC45NzY1NjIgMy4wODIwMzEgLTUuMjM4MjgxIDIuOTM3NSAtNS40Mzc1IEMgMi44MDA3ODEgLTUuNjMyODEyIDIuNTgyMDMxIC01LjczNDM3NSAyLjI4MTI1IC01LjczNDM3NSBDIDIuMDMxMjUgLTUuNzM0Mzc1IDEuODMyMDMxIC01LjY3MTg3NSAxLjY4NzUgLTUuNTQ2ODc1IEMgMS41NTA3ODEgLTUuNDI5Njg4IDEuNDU3MDMxIC01LjI4MTI1IDEuNDA2MjUgLTUuMDkzNzUgQyAxLjM2MzI4MSAtNC45MDYyNSAxLjM0Mzc1IC00LjY5NTMxMiAxLjM0Mzc1IC00LjQ2ODc1IEMgMS4xMzI4MTIgLTQuNDY4NzUgMC45NTcwMzEgLTQuNTAzOTA2IDAuODEyNSAtNC41NzgxMjUgQyAwLjY3NTc4MSAtNC42NjAxNTYgMC42MDkzNzUgLTQuODEyNSAwLjYwOTM3NSAtNS4wMzEyNSBDIDAuNjA5Mzc1IC01LjM1MTU2MiAwLjc1IC01LjYyNSAxLjAzMTI1IC01Ljg0Mzc1IEMgMS4zMTI1IC02LjA2MjUgMS43MjY1NjIgLTYuMTcxODc1IDIuMjgxMjUgLTYuMTcxODc1IEMgMi44MjAzMTIgLTYuMTcxODc1IDMuMjQyMTg4IC02LjAzOTA2MiAzLjU0Njg3NSAtNS43ODEyNSBDIDMuODU5Mzc1IC01LjUxOTUzMSA0LjAxNTYyNSAtNS4xNzU3ODEgNC4wMTU2MjUgLTQuNzUgQyA0LjAxNTYyNSAtNC4zNDM3NSAzLjg5MDYyNSAtMy45NTMxMjUgMy42NDA2MjUgLTMuNTc4MTI1IEMgMy4zOTA2MjUgLTMuMjAzMTI1IDMuMDM5MDYyIC0yLjc2OTUzMSAyLjU5Mzc1IC0yLjI4MTI1IEwgMS4xNTYyNSAtMC42ODc1IEwgMy4xMDkzNzUgLTAuNjg3NSBDIDMuMzY3MTg4IC0wLjY4NzUgMy41MzkwNjIgLTAuNzUgMy42MjUgLTAuODc1IEMgMy43MTg3NSAtMS4wMDc4MTIgMy43ODUxNTYgLTEuMTU2MjUgMy44MjgxMjUgLTEuMzEyNSBMIDMuODU5Mzc1IC0xLjQ2ODc1IEwgNC4yMTg3NSAtMS40Njg3NSBMIDQuMTg3NSAwIFogTSAwLjUxNTYyNSAwICIvPgo8L2c+CjwvZz4KPC9kZWZzPgo8ZyBmaWxsPSJyZ2IoMCUsIDAlLCAwJSkiIGZpbGwtb3BhY2l0eT0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTAtMCIgeD0iLTAuMDY2NDA2MiIgeT0iMTAuNTQ2ODc1Ii8+CjwvZz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTAiIHg9IjYuNTMxMjUiIHk9IjYuMTY5OTIyIi8+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTEtMSIgeD0iMTEuNTMxMjUiIHk9IjYuMTY5OTIyIi8+CjwvZz4KPC9zdmc+Cg==" alt="stem fc1ad1e8be2d915908e89ee69245646d" width="16" height="10"></span>), but are byte granular in size and alignment. Implicit regions checks are not applied to operations on explicit regions.</p>
</div>
<div class="paragraph">
<p>To access memory through explicit regions, a program must use the h-prefixed variants of normal load and store instructions (<code>hlw</code>, <code>hsw</code>, <code>hlh</code>, etc.). These instruction target the active region, but can be changed to use a different region as described in <a href="#sub_subsec_standard_profile">Chapter 3.5</a>. For example, <code>hlw x1, A(x0)</code> will succeed if the address being loaded is falls within explicit region 1, and there is a read permission set on that region, otherwise it will fail.</p>
</div>
<div class="sect2">
<h3 id="_region_characteristics">3.1. Region Characteristics</h3>
<div class="paragraph">
<p>HFI provides two different region sizes (<em>large/small</em>) for explicit regions to accommodate different granularity needs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Large regions:</strong> Can address up to 256 TiB (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuNzI1MzEiIGhlaWdodD0iMTAuNTQ4ODI4IiB2aWV3Qm94PSIwIDAgMTYuNzI1MzEgMTAuNTQ4ODI4Ij4KPGRlZnM+CjxnPgo8ZyBpZD0iZ2x5cGgtMC0wIj4KPHBhdGggZD0iTSAwLjczNDM3NSAwIEwgMC43MzQzNzUgLTAuODc1IEwgMi43MzQzNzUgLTMuMTg3NSBDIDMuMTYwMTU2IC0zLjY4NzUgMy40OTIxODggLTQuMTE3MTg4IDMuNzM0Mzc1IC00LjQ4NDM3NSBDIDMuOTg0Mzc1IC00Ljg0NzY1NiA0LjE2MDE1NiAtNS4xOTE0MDYgNC4yNjU2MjUgLTUuNTE1NjI1IEMgNC4zNzg5MDYgLTUuODQ3NjU2IDQuNDM3NSAtNi4xOTUzMTIgNC40Mzc1IC02LjU2MjUgQyA0LjQzNzUgLTcuMDE5NTMxIDQuMzM1OTM4IC03LjM5MDYyNSA0LjE0MDYyNSAtNy42NzE4NzUgQyAzLjk1MzEyNSAtNy45NTMxMjUgMy42NDQ1MzEgLTguMDkzNzUgMy4yMTg3NSAtOC4wOTM3NSBDIDIuODUxNTYyIC04LjA5Mzc1IDIuNTcwMzEyIC04LjAwMzkwNiAyLjM3NSAtNy44MjgxMjUgQyAyLjE4NzUgLTcuNjYwMTU2IDIuMDU0Njg4IC03LjQ0MTQwNiAxLjk4NDM3NSAtNy4xNzE4NzUgQyAxLjkyMTg3NSAtNi45MTAxNTYgMS44OTA2MjUgLTYuNjE3MTg4IDEuODkwNjI1IC02LjI5Njg3NSBDIDEuNjA5Mzc1IC02LjI5Njg3NSAxLjM2MzI4MSAtNi4zNDc2NTYgMS4xNTYyNSAtNi40NTMxMjUgQyAwLjk1NzAzMSAtNi41NjY0MDYgMC44NTkzNzUgLTYuNzczNDM4IDAuODU5Mzc1IC03LjA3ODEyNSBDIDAuODU5Mzc1IC03LjU0Njg3NSAxLjA1NDY4OCAtNy45Mjk2ODggMS40NTMxMjUgLTguMjM0Mzc1IEMgMS44NDc2NTYgLTguNTM1MTU2IDIuNDM3NSAtOC42ODc1IDMuMjE4NzUgLTguNjg3NSBDIDMuOTc2NTYyIC04LjY4NzUgNC41NzAzMTIgLTguNTAzOTA2IDUgLTguMTQwNjI1IEMgNS40Mzc1IC03Ljc3MzQzOCA1LjY1NjI1IC03LjI4OTA2MiA1LjY1NjI1IC02LjY4NzUgQyA1LjY1NjI1IC02LjEyNSA1LjQ3NjU2MiAtNS41NzgxMjUgNS4xMjUgLTUuMDQ2ODc1IEMgNC43Njk1MzEgLTQuNTE1NjI1IDQuMjczNDM4IC0zLjg5ODQzOCAzLjY0MDYyNSAtMy4yMDMxMjUgTCAxLjYyNSAtMC45NTMxMjUgTCA0LjM5MDYyNSAtMC45NTMxMjUgQyA0Ljc1MzkwNiAtMC45NTMxMjUgNSAtMS4wNDY4NzUgNS4xMjUgLTEuMjM0Mzc1IEMgNS4yNSAtMS40MjE4NzUgNS4zNDM3NSAtMS42Mjg5MDYgNS40MDYyNSAtMS44NTkzNzUgTCA1LjQ1MzEyNSAtMi4wNzgxMjUgTCA1Ljk1MzEyNSAtMi4wNzgxMjUgTCA1Ljg5MDYyNSAwIFogTSAwLjczNDM3NSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTAiPgo8cGF0aCBkPSJNIDEuODI4MTI1IDAgTCAxLjgyODEyNSAtMC4zNTkzNzUgTCAyLjA2MjUgLTAuMzU5Mzc1IEMgMi4yNTc4MTIgLTAuMzU5Mzc1IDIuNDI1NzgxIC0wLjM5NDUzMSAyLjU2MjUgLTAuNDY4NzUgQyAyLjY5NTMxMiAtMC41MzkwNjIgMi43NjU2MjUgLTAuNzA3MDMxIDIuNzY1NjI1IC0wLjk2ODc1IEwgMi43NjU2MjUgLTEuNjcxODc1IEwgMC4xNDA2MjUgLTEuNjcxODc1IEwgMC4xNDA2MjUgLTIuMDE1NjI1IEwgMi43ODEyNSAtNi4wNzgxMjUgTCAzLjU3ODEyNSAtNi4wNzgxMjUgTCAzLjU3ODEyNSAtMi4xNDA2MjUgTCA0LjY0MDYyNSAtMi4xNDA2MjUgTCA0LjY0MDYyNSAtMS42NzE4NzUgTCAzLjU3ODEyNSAtMS42NzE4NzUgTCAzLjU3ODEyNSAtMC45Njg3NSBDIDMuNTc4MTI1IC0wLjcwNzAzMSAzLjY0NDUzMSAtMC41MzkwNjIgMy43ODEyNSAtMC40Njg3NSBDIDMuOTI1NzgxIC0wLjM5NDUzMSA0LjA5Mzc1IC0wLjM1OTM3NSA0LjI4MTI1IC0wLjM1OTM3NSBMIDQuMzkwNjI1IC0wLjM1OTM3NSBMIDQuMzkwNjI1IDAgWiBNIDAuNzY1NjI1IC0yLjE0MDYyNSBMIDIuNzY1NjI1IC0yLjE0MDYyNSBMIDIuNzY1NjI1IC0zLjcxODc1IEMgMi43NjU2MjUgLTMuODgyODEyIDIuNzY1NjI1IC00LjA3MDMxMiAyLjc2NTYyNSAtNC4yODEyNSBDIDIuNzczNDM4IC00LjQ4ODI4MSAyLjc4NTE1NiAtNC42OTUzMTIgMi43OTY4NzUgLTQuOTA2MjUgQyAyLjgwNDY4OCAtNS4xMTMyODEgMi44MTY0MDYgLTUuMzA0Njg4IDIuODI4MTI1IC01LjQ4NDM3NSBDIDIuNzk2ODc1IC01LjQyOTY4OCAyLjc1IC01LjM0NzY1NiAyLjY4NzUgLTUuMjM0Mzc1IEMgMi42MjUgLTUuMTE3MTg4IDIuNTUwNzgxIC00Ljk5MjE4OCAyLjQ2ODc1IC00Ljg1OTM3NSBDIDIuMzk0NTMxIC00LjcyMjY1NiAyLjMyMDMxMiAtNC41OTM3NSAyLjI1IC00LjQ2ODc1IEMgMi4xNzU3ODEgLTQuMzUxNTYyIDIuMTEzMjgxIC00LjI1MzkwNiAyLjA2MjUgLTQuMTcxODc1IFogTSAwLjc2NTYyNSAtMi4xNDA2MjUgIi8+CjwvZz4KPGcgaWQ9ImdseXBoLTEtMSI+CjxwYXRoIGQ9Ik0gMi4zMjgxMjUgMC4wNzgxMjUgQyAxLjg5ODQzOCAwLjA3ODEyNSAxLjUzOTA2MiAwLjAwNzgxMjUgMS4yNSAtMC4xMjUgQyAwLjk2ODc1IC0wLjI2OTUzMSAwLjc1MzkwNiAtMC40NjA5MzggMC42MDkzNzUgLTAuNzAzMTI1IEMgMC40NjA5MzggLTAuOTUzMTI1IDAuMzkwNjI1IC0xLjIyNjU2MiAwLjM5MDYyNSAtMS41MzEyNSBDIDAuMzkwNjI1IC0xLjgwMDc4MSAwLjQ0NTMxMiAtMi4wMzEyNSAwLjU2MjUgLTIuMjE4NzUgQyAwLjY3NTc4MSAtMi40MDYyNSAwLjgyODEyNSAtMi41NjY0MDYgMS4wMTU2MjUgLTIuNzAzMTI1IEMgMS4yMTA5MzggLTIuODM1OTM4IDEuNDM3NSAtMi45NjA5MzggMS42ODc1IC0zLjA3ODEyNSBDIDEuMzYzMjgxIC0zLjI2NTYyNSAxLjA5NzY1NiAtMy40ODQzNzUgMC44OTA2MjUgLTMuNzM0Mzc1IEMgMC42OTE0MDYgLTMuOTg0Mzc1IDAuNTkzNzUgLTQuMjg1MTU2IDAuNTkzNzUgLTQuNjQwNjI1IEMgMC41OTM3NSAtNC44OTg0MzggMC42NTYyNSAtNS4xNDQ1MzEgMC43ODEyNSAtNS4zNzUgQyAwLjkwNjI1IC01LjYxMzI4MSAxLjA5NzY1NiAtNS44MDQ2ODggMS4zNTkzNzUgLTUuOTUzMTI1IEMgMS42Mjg5MDYgLTYuMDk3NjU2IDEuOTg0Mzc1IC02LjE3MTg3NSAyLjQyMTg3NSAtNi4xNzE4NzUgQyAyLjk2MDkzOCAtNi4xNzE4NzUgMy4zNzg5MDYgLTYuMDMxMjUgMy42NzE4NzUgLTUuNzUgQyAzLjk2MDkzOCAtNS40NzY1NjIgNC4xMDkzNzUgLTUuMTI4OTA2IDQuMTA5Mzc1IC00LjcwMzEyNSBDIDQuMTA5Mzc1IC00LjMyODEyNSA0IC00LjAzNTE1NiAzLjc4MTI1IC0zLjgyODEyNSBDIDMuNTcwMzEyIC0zLjYxNzE4OCAzLjI5Njg3NSAtMy40Mjk2ODggMi45NTMxMjUgLTMuMjY1NjI1IEMgMy4zNjcxODggLTMuMDY2NDA2IDMuNzA3MDMxIC0yLjgzNTkzOCAzLjk2ODc1IC0yLjU3ODEyNSBDIDQuMjM4MjgxIC0yLjMxNjQwNiA0LjM3NSAtMiA0LjM3NSAtMS42MjUgQyA0LjM3NSAtMS4wODIwMzEgNC4xODc1IC0wLjY2MDE1NiAzLjgxMjUgLTAuMzU5Mzc1IEMgMy40NDUzMTIgLTAuMDY2NDA2MiAyLjk1MzEyNSAwLjA3ODEyNSAyLjMyODEyNSAwLjA3ODEyNSBaIE0gMi41MzEyNSAtMy40NTMxMjUgQyAyLjg1MTU2MiAtMy42MTcxODggMy4wNjY0MDYgLTMuNzk2ODc1IDMuMTcxODc1IC0zLjk4NDM3NSBDIDMuMjg1MTU2IC00LjE3OTY4OCAzLjM0Mzc1IC00LjQyNTc4MSAzLjM0Mzc1IC00LjcxODc1IEMgMy4zNDM3NSAtNC44OTQ1MzEgMy4zMTI1IC01LjA2MjUgMy4yNSAtNS4yMTg3NSBDIDMuMTg3NSAtNS4zNzUgMy4wODIwMzEgLTUuNTAzOTA2IDIuOTM3NSAtNS42MDkzNzUgQyAyLjgwMDc4MSAtNS43MTA5MzggMi42MTMyODEgLTUuNzY1NjI1IDIuMzc1IC01Ljc2NTYyNSBDIDIuMDYyNSAtNS43NjU2MjUgMS44MTY0MDYgLTUuNjY0MDYyIDEuNjQwNjI1IC01LjQ2ODc1IEMgMS40NzI2NTYgLTUuMjgxMjUgMS4zOTA2MjUgLTUuMDM5MDYyIDEuMzkwNjI1IC00Ljc1IEMgMS4zOTA2MjUgLTQuNDM3NSAxLjQ4NDM3NSAtNC4xODc1IDEuNjcxODc1IC00IEMgMS44NjcxODggLTMuODEyNSAyLjE1NjI1IC0zLjYyODkwNiAyLjUzMTI1IC0zLjQ1MzEyNSBaIE0gMi4zNzUgLTAuMzEyNSBDIDIuNzM4MjgxIC0wLjMxMjUgMy4wMzEyNSAtMC40MTQwNjIgMy4yNSAtMC42MjUgQyAzLjQ3NjU2MiAtMC44MzIwMzEgMy41OTM3NSAtMS4xMDE1NjIgMy41OTM3NSAtMS40Mzc1IEMgMy41OTM3NSAtMS43MjY1NjIgMy40NzY1NjIgLTEuOTc2NTYyIDMuMjUgLTIuMTg3NSBDIDMuMDMxMjUgLTIuNDA2MjUgMi42NDQ1MzEgLTIuNjMyODEyIDIuMDkzNzUgLTIuODc1IEMgMS44MjAzMTIgLTIuNzM4MjgxIDEuNjA5Mzc1IC0yLjU1MDc4MSAxLjQ1MzEyNSAtMi4zMTI1IEMgMS4yOTY4NzUgLTIuMDgyMDMxIDEuMjE4NzUgLTEuODA0Njg4IDEuMjE4NzUgLTEuNDg0Mzc1IEMgMS4yMTg3NSAtMS4xNDA2MjUgMS4zMTI1IC0wLjg1OTM3NSAxLjUgLTAuNjQwNjI1IEMgMS42OTUzMTIgLTAuNDIxODc1IDEuOTg4MjgxIC0wLjMxMjUgMi4zNzUgLTAuMzEyNSBaIE0gMi4zNzUgLTAuMzEyNSAiLz4KPC9nPgo8L2c+CjwvZGVmcz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0wLTAiIHg9Ii0wLjA2NjQwNjIiIHk9IjEwLjU0Njg3NSIvPgo8L2c+CjxnIGZpbGw9InJnYigwJSwgMCUsIDAlKSIgZmlsbC1vcGFjaXR5PSIxIj4KPHVzZSB4bGluazpocmVmPSIjZ2x5cGgtMS0wIiB4PSI2Ljg4MjgxMiIgeT0iNi4xNjk5MjIiLz4KPHVzZSB4bGluazpocmVmPSIjZ2x5cGgtMS0xIiB4PSIxMS44ODI4MTIiIHk9IjYuMTY5OTIyIi8+CjwvZz4KPC9zdmc+Cg==" alt="stem 3d25890e9a3b06914918d4b71e33e8c5" width="16" height="10"></span>) and are sized and aligned to multiples of 64K (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuMjY1MzQ5IiBoZWlnaHQ9IjEwLjU0ODgyOCIgdmlld0JveD0iMCAwIDE2LjI2NTM0OSAxMC41NDg4MjgiPgo8ZGVmcz4KPGc+CjxnIGlkPSJnbHlwaC0wLTAiPgo8cGF0aCBkPSJNIDAuNzM0Mzc1IDAgTCAwLjczNDM3NSAtMC44NzUgTCAyLjczNDM3NSAtMy4xODc1IEMgMy4xNjAxNTYgLTMuNjg3NSAzLjQ5MjE4OCAtNC4xMTcxODggMy43MzQzNzUgLTQuNDg0Mzc1IEMgMy45ODQzNzUgLTQuODQ3NjU2IDQuMTYwMTU2IC01LjE5MTQwNiA0LjI2NTYyNSAtNS41MTU2MjUgQyA0LjM3ODkwNiAtNS44NDc2NTYgNC40Mzc1IC02LjE5NTMxMiA0LjQzNzUgLTYuNTYyNSBDIDQuNDM3NSAtNy4wMTk1MzEgNC4zMzU5MzggLTcuMzkwNjI1IDQuMTQwNjI1IC03LjY3MTg3NSBDIDMuOTUzMTI1IC03Ljk1MzEyNSAzLjY0NDUzMSAtOC4wOTM3NSAzLjIxODc1IC04LjA5Mzc1IEMgMi44NTE1NjIgLTguMDkzNzUgMi41NzAzMTIgLTguMDAzOTA2IDIuMzc1IC03LjgyODEyNSBDIDIuMTg3NSAtNy42NjAxNTYgMi4wNTQ2ODggLTcuNDQxNDA2IDEuOTg0Mzc1IC03LjE3MTg3NSBDIDEuOTIxODc1IC02LjkxMDE1NiAxLjg5MDYyNSAtNi42MTcxODggMS44OTA2MjUgLTYuMjk2ODc1IEMgMS42MDkzNzUgLTYuMjk2ODc1IDEuMzYzMjgxIC02LjM0NzY1NiAxLjE1NjI1IC02LjQ1MzEyNSBDIDAuOTU3MDMxIC02LjU2NjQwNiAwLjg1OTM3NSAtNi43NzM0MzggMC44NTkzNzUgLTcuMDc4MTI1IEMgMC44NTkzNzUgLTcuNTQ2ODc1IDEuMDU0Njg4IC03LjkyOTY4OCAxLjQ1MzEyNSAtOC4yMzQzNzUgQyAxLjg0NzY1NiAtOC41MzUxNTYgMi40Mzc1IC04LjY4NzUgMy4yMTg3NSAtOC42ODc1IEMgMy45NzY1NjIgLTguNjg3NSA0LjU3MDMxMiAtOC41MDM5MDYgNSAtOC4xNDA2MjUgQyA1LjQzNzUgLTcuNzczNDM4IDUuNjU2MjUgLTcuMjg5MDYyIDUuNjU2MjUgLTYuNjg3NSBDIDUuNjU2MjUgLTYuMTI1IDUuNDc2NTYyIC01LjU3ODEyNSA1LjEyNSAtNS4wNDY4NzUgQyA0Ljc2OTUzMSAtNC41MTU2MjUgNC4yNzM0MzggLTMuODk4NDM4IDMuNjQwNjI1IC0zLjIwMzEyNSBMIDEuNjI1IC0wLjk1MzEyNSBMIDQuMzkwNjI1IC0wLjk1MzEyNSBDIDQuNzUzOTA2IC0wLjk1MzEyNSA1IC0xLjA0Njg3NSA1LjEyNSAtMS4yMzQzNzUgQyA1LjI1IC0xLjQyMTg3NSA1LjM0Mzc1IC0xLjYyODkwNiA1LjQwNjI1IC0xLjg1OTM3NSBMIDUuNDUzMTI1IC0yLjA3ODEyNSBMIDUuOTUzMTI1IC0yLjA3ODEyNSBMIDUuODkwNjI1IDAgWiBNIDAuNzM0Mzc1IDAgIi8+CjwvZz4KPGcgaWQ9ImdseXBoLTEtMCI+CjxwYXRoIGQ9Ik0gMC44MTI1IDAgTCAwLjgxMjUgLTAuMzU5Mzc1IEwgMS4zOTA2MjUgLTAuMzU5Mzc1IEMgMS41NzgxMjUgLTAuMzU5Mzc1IDEuNzM4MjgxIC0wLjM5NDUzMSAxLjg3NSAtMC40Njg3NSBDIDIuMDE5NTMxIC0wLjUzOTA2MiAyLjA5Mzc1IC0wLjcwNzAzMSAyLjA5Mzc1IC0wLjk2ODc1IEwgMi4wOTM3NSAtNS40Mzc1IEMgMS44NzUgLTUuMTc1NzgxIDEuNjc1NzgxIC00Ljk2MDkzOCAxLjUgLTQuNzk2ODc1IEMgMS4zMzIwMzEgLTQuNjQwNjI1IDEuMTYwMTU2IC00LjU2MjUgMC45ODQzNzUgLTQuNTYyNSBDIDAuODU5Mzc1IC00LjU2MjUgMC43NTM5MDYgLTQuNjAxNTYyIDAuNjcxODc1IC00LjY4NzUgQyAwLjU5NzY1NiAtNC43Njk1MzEgMC41NjI1IC00Ljg3ODkwNiAwLjU2MjUgLTUuMDE1NjI1IEMgMC43MjY1NjIgLTUuMDU0Njg4IDAuOTA2MjUgLTUuMTI1IDEuMDkzNzUgLTUuMjE4NzUgQyAxLjI4OTA2MiAtNS4zMTI1IDEuNTMxMjUgLTUuNDYwOTM4IDEuODEyNSAtNS42NzE4NzUgTCAyLjQwNjI1IC02LjEwOTM3NSBMIDIuOTUzMTI1IC02LjEwOTM3NSBMIDIuOTUzMTI1IC0wLjk2ODc1IEMgMi45NTMxMjUgLTAuNzA3MDMxIDMuMDE5NTMxIC0wLjUzOTA2MiAzLjE1NjI1IC0wLjQ2ODc1IEMgMy4yODkwNjIgLTAuMzk0NTMxIDMuNDUzMTI1IC0wLjM1OTM3NSAzLjY0MDYyNSAtMC4zNTkzNzUgTCA0LjA2MjUgLTAuMzU5Mzc1IEwgNC4wNjI1IDAgWiBNIDAuODEyNSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTEiPgo8cGF0aCBkPSJNIDIuNSAwLjA3ODEyNSBDIDIuMTI1IDAuMDc4MTI1IDEuNzg1MTU2IC0wLjAyMzQzNzUgMS40ODQzNzUgLTAuMjM0Mzc1IEMgMS4xNzk2ODggLTAuNDQxNDA2IDAuOTQxNDA2IC0wLjc3MzQzOCAwLjc2NTYyNSAtMS4yMzQzNzUgQyAwLjU5NzY1NiAtMS43MDMxMjUgMC41MTU2MjUgLTIuMzEyNSAwLjUxNTYyNSAtMy4wNjI1IEMgMC41MTU2MjUgLTMuNDY4NzUgMC41NjI1IC0zLjg1MTU2MiAwLjY1NjI1IC00LjIxODc1IEMgMC43NSAtNC41OTM3NSAwLjg4MjgxMiAtNC45MjU3ODEgMS4wNjI1IC01LjIxODc1IEMgMS4yNSAtNS41MDc4MTIgMS40ODQzNzUgLTUuNzM4MjgxIDEuNzY1NjI1IC01LjkwNjI1IEMgMi4wNDY4NzUgLTYuMDgyMDMxIDIuMzY3MTg4IC02LjE3MTg3NSAyLjczNDM3NSAtNi4xNzE4NzUgQyAzLjIxMDkzOCAtNi4xNzE4NzUgMy41NjY0MDYgLTYuMDc4MTI1IDMuNzk2ODc1IC01Ljg5MDYyNSBDIDQuMDIzNDM4IC01LjcxMDkzOCA0LjE0MDYyNSAtNS41MDM5MDYgNC4xNDA2MjUgLTUuMjY1NjI1IEMgNC4xNDA2MjUgLTQuOTI5Njg4IDMuOTIxODc1IC00Ljc2NTYyNSAzLjQ4NDM3NSAtNC43NjU2MjUgQyAzLjQ4NDM3NSAtNS4wMzUxNTYgMy40MjU3ODEgLTUuMjY1NjI1IDMuMzEyNSAtNS40NTMxMjUgQyAzLjIwNzAzMSAtNS42NDg0MzggMy4wMTU2MjUgLTUuNzUgMi43MzQzNzUgLTUuNzUgQyAyLjMxNjQwNiAtNS43NSAxLjk5MjE4OCAtNS41MzUxNTYgMS43NjU2MjUgLTUuMTA5Mzc1IEMgMS41NDY4NzUgLTQuNjkxNDA2IDEuNDIxODc1IC00LjA3MDMxMiAxLjM5MDYyNSAtMy4yNSBDIDEuNTM1MTU2IC0zLjM2MzI4MSAxLjcwNzAzMSAtMy40Njg3NSAxLjkwNjI1IC0zLjU2MjUgQyAyLjEwMTU2MiAtMy42NTYyNSAyLjMzNTkzOCAtMy43MDMxMjUgMi42MDkzNzUgLTMuNzAzMTI1IEMgMy4xMjg5MDYgLTMuNzAzMTI1IDMuNTQ2ODc1IC0zLjU0Njg3NSAzLjg1OTM3NSAtMy4yMzQzNzUgQyA0LjE3MTg3NSAtMi45MjE4NzUgNC4zMjgxMjUgLTIuNDkyMTg4IDQuMzI4MTI1IC0xLjk1MzEyNSBDIDQuMzI4MTI1IC0xLjU1NDY4OCA0LjI1MzkwNiAtMS4yMDMxMjUgNC4xMDkzNzUgLTAuODkwNjI1IEMgMy45NjA5MzggLTAuNTg1OTM4IDMuNzUzOTA2IC0wLjM0NzY1NiAzLjQ4NDM3NSAtMC4xNzE4NzUgQyAzLjIxMDkzOCAtMC4wMDM5MDYyNSAyLjg4MjgxMiAwLjA3ODEyNSAyLjUgMC4wNzgxMjUgWiBNIDIuNTE1NjI1IC0wLjM5MDYyNSBDIDIuODE2NDA2IC0wLjM5MDYyNSAzLjA0Njg3NSAtMC41MDM5MDYgMy4yMDMxMjUgLTAuNzM0Mzc1IEMgMy4zNjcxODggLTAuOTcyNjU2IDMuNDUzMTI1IC0xLjM0NzY1NiAzLjQ1MzEyNSAtMS44NTkzNzUgQyAzLjQ1MzEyNSAtMi4zNDc2NTYgMy4zNjMyODEgLTIuNzAzMTI1IDMuMTg3NSAtMi45MjE4NzUgQyAzLjAxOTUzMSAtMy4xNDg0MzggMi43Njk1MzEgLTMuMjY1NjI1IDIuNDM3NSAtMy4yNjU2MjUgQyAyLjIxODc1IC0zLjI2NTYyNSAyLjAxNTYyNSAtMy4yMTA5MzggMS44MjgxMjUgLTMuMTA5Mzc1IEMgMS42NDg0MzggLTMuMDAzOTA2IDEuNTAzOTA2IC0yLjg5MDYyNSAxLjM5MDYyNSAtMi43NjU2MjUgQyAxLjM5ODQzOCAtMS45MTAxNTYgMS41MDM5MDYgLTEuMzAwNzgxIDEuNzAzMTI1IC0wLjkzNzUgQyAxLjkxMDE1NiAtMC41NzAzMTIgMi4xNzk2ODggLTAuMzkwNjI1IDIuNTE1NjI1IC0wLjM5MDYyNSBaIE0gMi41MTU2MjUgLTAuMzkwNjI1ICIvPgo8L2c+CjwvZz4KPC9kZWZzPgo8ZyBmaWxsPSJyZ2IoMCUsIDAlLCAwJSkiIGZpbGwtb3BhY2l0eT0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTAtMCIgeD0iLTAuMDY2NDA2MiIgeT0iMTAuNTQ2ODc1Ii8+CjwvZz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTAiIHg9IjYuNDY0ODQ0IiB5PSI2LjE2OTkyMiIvPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTEiIHg9IjExLjQ2NDg0NCIgeT0iNi4xNjk5MjIiLz4KPC9nPgo8L3N2Zz4K" alt="stem e4da6f057edacac14e5878a7774ba26c" width="16" height="10"></span>).</p>
</li>
<li>
<p><strong>Small regions:</strong> Can only address up to 4GiB (<span class="image"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYuMjMxMTciIGhlaWdodD0iMTAuNTQ4ODI4IiB2aWV3Qm94PSIwIDAgMTYuMjMxMTcgMTAuNTQ4ODI4Ij4KPGRlZnM+CjxnPgo8ZyBpZD0iZ2x5cGgtMC0wIj4KPHBhdGggZD0iTSAwLjczNDM3NSAwIEwgMC43MzQzNzUgLTAuODc1IEwgMi43MzQzNzUgLTMuMTg3NSBDIDMuMTYwMTU2IC0zLjY4NzUgMy40OTIxODggLTQuMTE3MTg4IDMuNzM0Mzc1IC00LjQ4NDM3NSBDIDMuOTg0Mzc1IC00Ljg0NzY1NiA0LjE2MDE1NiAtNS4xOTE0MDYgNC4yNjU2MjUgLTUuNTE1NjI1IEMgNC4zNzg5MDYgLTUuODQ3NjU2IDQuNDM3NSAtNi4xOTUzMTIgNC40Mzc1IC02LjU2MjUgQyA0LjQzNzUgLTcuMDE5NTMxIDQuMzM1OTM4IC03LjM5MDYyNSA0LjE0MDYyNSAtNy42NzE4NzUgQyAzLjk1MzEyNSAtNy45NTMxMjUgMy42NDQ1MzEgLTguMDkzNzUgMy4yMTg3NSAtOC4wOTM3NSBDIDIuODUxNTYyIC04LjA5Mzc1IDIuNTcwMzEyIC04LjAwMzkwNiAyLjM3NSAtNy44MjgxMjUgQyAyLjE4NzUgLTcuNjYwMTU2IDIuMDU0Njg4IC03LjQ0MTQwNiAxLjk4NDM3NSAtNy4xNzE4NzUgQyAxLjkyMTg3NSAtNi45MTAxNTYgMS44OTA2MjUgLTYuNjE3MTg4IDEuODkwNjI1IC02LjI5Njg3NSBDIDEuNjA5Mzc1IC02LjI5Njg3NSAxLjM2MzI4MSAtNi4zNDc2NTYgMS4xNTYyNSAtNi40NTMxMjUgQyAwLjk1NzAzMSAtNi41NjY0MDYgMC44NTkzNzUgLTYuNzczNDM4IDAuODU5Mzc1IC03LjA3ODEyNSBDIDAuODU5Mzc1IC03LjU0Njg3NSAxLjA1NDY4OCAtNy45Mjk2ODggMS40NTMxMjUgLTguMjM0Mzc1IEMgMS44NDc2NTYgLTguNTM1MTU2IDIuNDM3NSAtOC42ODc1IDMuMjE4NzUgLTguNjg3NSBDIDMuOTc2NTYyIC04LjY4NzUgNC41NzAzMTIgLTguNTAzOTA2IDUgLTguMTQwNjI1IEMgNS40Mzc1IC03Ljc3MzQzOCA1LjY1NjI1IC03LjI4OTA2MiA1LjY1NjI1IC02LjY4NzUgQyA1LjY1NjI1IC02LjEyNSA1LjQ3NjU2MiAtNS41NzgxMjUgNS4xMjUgLTUuMDQ2ODc1IEMgNC43Njk1MzEgLTQuNTE1NjI1IDQuMjczNDM4IC0zLjg5ODQzOCAzLjY0MDYyNSAtMy4yMDMxMjUgTCAxLjYyNSAtMC45NTMxMjUgTCA0LjM5MDYyNSAtMC45NTMxMjUgQyA0Ljc1MzkwNiAtMC45NTMxMjUgNSAtMS4wNDY4NzUgNS4xMjUgLTEuMjM0Mzc1IEMgNS4yNSAtMS40MjE4NzUgNS4zNDM3NSAtMS42Mjg5MDYgNS40MDYyNSAtMS44NTkzNzUgTCA1LjQ1MzEyNSAtMi4wNzgxMjUgTCA1Ljk1MzEyNSAtMi4wNzgxMjUgTCA1Ljg5MDYyNSAwIFogTSAwLjczNDM3NSAwICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTAiPgo8cGF0aCBkPSJNIDIuMTA5Mzc1IDAuMDc4MTI1IEMgMS41NDY4NzUgMC4wNzgxMjUgMS4xMzI4MTIgLTAuMDE1NjI1IDAuODc1IC0wLjIwMzEyNSBDIDAuNjI1IC0wLjM5MDYyNSAwLjUgLTAuNjA5Mzc1IDAuNSAtMC44NTkzNzUgQyAwLjUgLTEuMDIzNDM4IDAuNTQ2ODc1IC0xLjE1NjI1IDAuNjQwNjI1IC0xLjI1IEMgMC43NDIxODggLTEuMzUxNTYyIDAuODc1IC0xLjQwNjI1IDEuMDMxMjUgLTEuNDA2MjUgQyAxLjAzMTI1IC0xLjExMzI4MSAxLjEyNSAtMC44NjcxODggMS4zMTI1IC0wLjY3MTg3NSBDIDEuNSAtMC40NzI2NTYgMS43NjU2MjUgLTAuMzc1IDIuMTA5Mzc1IC0wLjM3NSBDIDIuMzM1OTM4IC0wLjM3NSAyLjU0Njg3NSAtMC40MTQwNjIgMi43MzQzNzUgLTAuNSBDIDIuOTIxODc1IC0wLjU5Mzc1IDMuMDcwMzEyIC0wLjczODI4MSAzLjE4NzUgLTAuOTM3NSBDIDMuMzEyNSAtMS4xMzI4MTIgMy4zNzUgLTEuNDA2MjUgMy4zNzUgLTEuNzUgQyAzLjM3NSAtMi4xMDE1NjIgMy4yMzQzNzUgLTIuMzgyODEyIDIuOTUzMTI1IC0yLjU5Mzc1IEMgMi42Nzk2ODggLTIuODEyNSAyLjMxMjUgLTIuOTIxODc1IDEuODQzNzUgLTIuOTIxODc1IEwgMS41NjI1IC0yLjkyMTg3NSBMIDEuNTYyNSAtMy4zNTkzNzUgTCAxLjg0Mzc1IC0zLjM1OTM3NSBDIDIuMDkzNzUgLTMuMzU5Mzc1IDIuMzE2NDA2IC0zLjQxMDE1NiAyLjUxNTYyNSAtMy41MTU2MjUgQyAyLjcxMDkzOCAtMy42Mjg5MDYgMi44NjcxODggLTMuNzg1MTU2IDIuOTg0Mzc1IC0zLjk4NDM3NSBDIDMuMTA5Mzc1IC00LjE3OTY4OCAzLjE3MTg3NSAtNC40MTQwNjIgMy4xNzE4NzUgLTQuNjg3NSBDIDMuMTcxODc1IC01LjAxOTUzMSAzLjEwMTU2MiAtNS4yNzM0MzggMi45Njg3NSAtNS40NTMxMjUgQyAyLjgzMjAzMSAtNS42NDA2MjUgMi41OTc2NTYgLTUuNzM0Mzc1IDIuMjY1NjI1IC01LjczNDM3NSBDIDIuMDAzOTA2IC01LjczNDM3NSAxLjgwNDY4OCAtNS42NzE4NzUgMS42NzE4NzUgLTUuNTQ2ODc1IEMgMS41MzUxNTYgLTUuNDI5Njg4IDEuNDQxNDA2IC01LjI4MTI1IDEuMzkwNjI1IC01LjA5Mzc1IEMgMS4zNDc2NTYgLTQuOTA2MjUgMS4zMjgxMjUgLTQuNjk1MzEyIDEuMzI4MTI1IC00LjQ2ODc1IEMgMS4xMTcxODggLTQuNDY4NzUgMC45NDE0MDYgLTQuNTAzOTA2IDAuNzk2ODc1IC00LjU3ODEyNSBDIDAuNjYwMTU2IC00LjY2MDE1NiAwLjU5Mzc1IC00LjgxMjUgMC41OTM3NSAtNS4wMzEyNSBDIDAuNTkzNzUgLTUuMzUxNTYyIDAuNzM0Mzc1IC01LjYyNSAxLjAxNTYyNSAtNS44NDM3NSBDIDEuMjk2ODc1IC02LjA2MjUgMS43MTA5MzggLTYuMTcxODc1IDIuMjY1NjI1IC02LjE3MTg3NSBDIDIuODA0Njg4IC02LjE3MTg3NSAzLjIzODI4MSAtNi4wNTA3ODEgMy41NjI1IC01LjgxMjUgQyAzLjg4MjgxMiAtNS41NzAzMTIgNC4wNDY4NzUgLTUuMjM4MjgxIDQuMDQ2ODc1IC00LjgxMjUgQyA0LjA0Njg3NSAtNC41NTA3ODEgMy45ODgyODEgLTQuMzE2NDA2IDMuODc1IC00LjEwOTM3NSBDIDMuNzU3ODEyIC0zLjg5ODQzOCAzLjU5NzY1NiAtMy43MTg3NSAzLjM5MDYyNSAtMy41NjI1IEMgMy4xNzk2ODggLTMuNDE0MDYyIDIuOTQ1MzEyIC0zLjMxMjUgMi42ODc1IC0zLjI1IEMgMi44NDM3NSAtMy4yMjY1NjIgMy4wMDc4MTIgLTMuMTkxNDA2IDMuMTg3NSAtMy4xNDA2MjUgQyAzLjM3NSAtMy4wODU5MzggMy41NDY4NzUgLTMuMDAzOTA2IDMuNzAzMTI1IC0yLjg5MDYyNSBDIDMuODY3MTg4IC0yLjc3MzQzOCA0LjAwMzkwNiAtMi42MjUgNC4xMDkzNzUgLTIuNDM3NSBDIDQuMjEwOTM4IC0yLjI1IDQuMjY1NjI1IC0yLjAxNTYyNSA0LjI2NTYyNSAtMS43MzQzNzUgQyA0LjI2NTYyNSAtMS4zOTA2MjUgNC4xOTUzMTIgLTEuMDk3NjU2IDQuMDYyNSAtMC44NTkzNzUgQyAzLjkzNzUgLTAuNjI4OTA2IDMuNzY1NjI1IC0wLjQ0NTMxMiAzLjU0Njg3NSAtMC4zMTI1IEMgMy4zMzU5MzggLTAuMTc1NzgxIDMuMTAxNTYyIC0wLjA3ODEyNSAyLjg0Mzc1IC0wLjAxNTYyNSBDIDIuNTkzNzUgMC4wNDY4NzUgMi4zNDc2NTYgMC4wNzgxMjUgMi4xMDkzNzUgMC4wNzgxMjUgWiBNIDIuMTA5Mzc1IDAuMDc4MTI1ICIvPgo8L2c+CjxnIGlkPSJnbHlwaC0xLTEiPgo8cGF0aCBkPSJNIDAuNTE1NjI1IDAgTCAwLjUxNTYyNSAtMC42MjUgTCAxLjkzNzUgLTIuMjY1NjI1IEMgMi4yMzgyODEgLTIuNjE3MTg4IDIuNDc2NTYyIC0yLjkyMTg3NSAyLjY1NjI1IC0zLjE3MTg3NSBDIDIuODMyMDMxIC0zLjQyOTY4OCAyLjk1NzAzMSAtMy42NzU3ODEgMy4wMzEyNSAtMy45MDYyNSBDIDMuMTEzMjgxIC00LjE0NDUzMSAzLjE1NjI1IC00LjM5NDUzMSAzLjE1NjI1IC00LjY1NjI1IEMgMy4xNTYyNSAtNC45NzY1NjIgMy4wODIwMzEgLTUuMjM4MjgxIDIuOTM3NSAtNS40Mzc1IEMgMi44MDA3ODEgLTUuNjMyODEyIDIuNTgyMDMxIC01LjczNDM3NSAyLjI4MTI1IC01LjczNDM3NSBDIDIuMDMxMjUgLTUuNzM0Mzc1IDEuODMyMDMxIC01LjY3MTg3NSAxLjY4NzUgLTUuNTQ2ODc1IEMgMS41NTA3ODEgLTUuNDI5Njg4IDEuNDU3MDMxIC01LjI4MTI1IDEuNDA2MjUgLTUuMDkzNzUgQyAxLjM2MzI4MSAtNC45MDYyNSAxLjM0Mzc1IC00LjY5NTMxMiAxLjM0Mzc1IC00LjQ2ODc1IEMgMS4xMzI4MTIgLTQuNDY4NzUgMC45NTcwMzEgLTQuNTAzOTA2IDAuODEyNSAtNC41NzgxMjUgQyAwLjY3NTc4MSAtNC42NjAxNTYgMC42MDkzNzUgLTQuODEyNSAwLjYwOTM3NSAtNS4wMzEyNSBDIDAuNjA5Mzc1IC01LjM1MTU2MiAwLjc1IC01LjYyNSAxLjAzMTI1IC01Ljg0Mzc1IEMgMS4zMTI1IC02LjA2MjUgMS43MjY1NjIgLTYuMTcxODc1IDIuMjgxMjUgLTYuMTcxODc1IEMgMi44MjAzMTIgLTYuMTcxODc1IDMuMjQyMTg4IC02LjAzOTA2MiAzLjU0Njg3NSAtNS43ODEyNSBDIDMuODU5Mzc1IC01LjUxOTUzMSA0LjAxNTYyNSAtNS4xNzU3ODEgNC4wMTU2MjUgLTQuNzUgQyA0LjAxNTYyNSAtNC4zNDM3NSAzLjg5MDYyNSAtMy45NTMxMjUgMy42NDA2MjUgLTMuNTc4MTI1IEMgMy4zOTA2MjUgLTMuMjAzMTI1IDMuMDM5MDYyIC0yLjc2OTUzMSAyLjU5Mzc1IC0yLjI4MTI1IEwgMS4xNTYyNSAtMC42ODc1IEwgMy4xMDkzNzUgLTAuNjg3NSBDIDMuMzY3MTg4IC0wLjY4NzUgMy41MzkwNjIgLTAuNzUgMy42MjUgLTAuODc1IEMgMy43MTg3NSAtMS4wMDc4MTIgMy43ODUxNTYgLTEuMTU2MjUgMy44MjgxMjUgLTEuMzEyNSBMIDMuODU5Mzc1IC0xLjQ2ODc1IEwgNC4yMTg3NSAtMS40Njg3NSBMIDQuMTg3NSAwIFogTSAwLjUxNTYyNSAwICIvPgo8L2c+CjwvZz4KPC9kZWZzPgo8ZyBmaWxsPSJyZ2IoMCUsIDAlLCAwJSkiIGZpbGwtb3BhY2l0eT0iMSI+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTAtMCIgeD0iLTAuMDY2NDA2MiIgeT0iMTAuNTQ2ODc1Ii8+CjwvZz4KPGcgZmlsbD0icmdiKDAlLCAwJSwgMCUpIiBmaWxsLW9wYWNpdHk9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNnbHlwaC0xLTAiIHg9IjYuNTMxMjUiIHk9IjYuMTY5OTIyIi8+Cjx1c2UgeGxpbms6aHJlZj0iI2dseXBoLTEtMSIgeD0iMTEuNTMxMjUiIHk9IjYuMTY5OTIyIi8+CjwvZz4KPC9zdmc+Cg==" alt="stem fc1ad1e8be2d915908e89ee69245646d" width="16" height="10"></span>) but are byte-granular in size and alignment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unlike implicit regions which are at lesast 64 bytes, there is no minimum size on small explicit regions, while the smallest large explicit region is 64K. Each explicit region has a 64-bit base register, a 64-bit bound register, and a 1-bit field specifying whether this is a large region or small region.</p>
</div>
<div class="paragraph">
<p><strong>Design Rationale</strong></p>
</div>
<div class="paragraph">
<p>The large and small region sizes and alignment constraints on explicit regions allow us to implement explicit regions with a single 32-bit comparator. For small regions, HFI checks the least-significant 32-bits is within bounds, and ensures the top bits are zero. For large regions, HFI will drop the first 16-bits, and compare bits 16-48, while checking the top bits are zero. Like Intel x86, RISCV typically support a 48-bit virtual address space, on which this spec is based. This design rationale also applies to Sv39 or Sv57, though the comparator lengths need to be adjusted accordingly.</p>
</div>
<div class="paragraph">
<p>While allowing regions that support arbitrary address ranges at with any size and alignment is conceptually simpler than specialized large and small regions, our restrictions allow bounds checking with very simple hardware. For base integer loads/stores, HFI&#8217;s large and small regions constraints can be checked with a single 32-bit comparator, rather than the more costly multiple 64-bit comparators needed to check arbitrary region bounds.</p>
</div>
<div class="paragraph">
<p>Explicit regions' added granularity is critical for supporting Wasm heaps, which grow in 64K increments <span class="citation">(<a href="#wasm">Haas et al.&#44; 2017</a>)</span>---while byte granularity is critical for efficiently sharing individual memory objects and sandboxing legacy code, as existing buffers can be shared in-place changing code or allocators.</p>
</div>
<div class="paragraph">
<p>To safely implement explicit bounds checks, the bounds check must be applied to the operand of an operation (i.e., the address being loaded/stored to) plus the size of the operand, to ensure that longer operations do not exceed bounds checks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_and_accessing_explicit_regions">3.2. Configuring and Accessing Explicit Regions</h3>
<div class="paragraph">
<p>Configuration for explicit regions take place through the same interface as implicit regions, detailed in <a href="#subsec_manip_regions">Chapter 2.3.2</a>. The only difference is that the runtime passes the bound of an explicit region instead of the mask of an implicit region. The runtime would still need to specify a region number to configure before setting the base and bound.</p>
</div>
<div class="paragraph">
<p>In addition to the two implicit regions defined in Chapter 2, this chapter defines a third explicit data region with a <code>region_number_t</code> of 3. Notably, <code>hfigetregionbound</code> returns the mask if the region is implicit (<code>region_number_t</code> is 1 or 2) and the bound if the region is explicit (<code>region_number_t</code> is 3). With a new explicit data region, bit 5 to 8 in the permission vector now correspond to explicit region 3: bit 5, 6 and 7 indicate enabled state, read and write permissions respectively, while bit 8 indicates if the explicit data region is a large region (i.e., a region with a bound greater than 4GB).</p>
</div>
<div class="paragraph">
<p>To access memory through explicit regions, a program must use the <code>h-prefixed</code> variants of normal load and store instructions (<code>hlw</code>, <code>hsw</code>, <code>hlh</code>, etc.). These instructions target the active region but can be changed to use a different region as described in the Standard Profile section. For example, <code>hlw x1, A(x0)</code> will succeed only if the address <code>Base(ActiveRegion) + A</code> falls within the active explicit region and the region has read permissions enabled.</p>
</div>
<div class="paragraph">
<p>In terms of size and alignment, unaligned memory operations that are split by the micro-architecture into independent operations will be checked independently by HFI. If one split faults, the original fused instruction will fault. However, the split operation that is within bounds is allowed to have visible <em>micro-architectural</em> side effects within the sandbox. To safely implement explicit bounds checks, the check must be applied to the effective address plus the size of the operand to ensure that multi-byte operations do not cross the region boundary. The smallest large explicit region is 64K; there is no minimum size on small explicit regions. The behavior of regions that do not meet these minimums is undefined.</p>
</div>
<div class="paragraph">
<p>When the runtime grants access to memory, it can choose to have an explicit region(s) for the applications heap(s) and inputs, as the SFI compiler can use h-prefixed instructions for accessing these directly. This allows it to exploit the greater flexibility of explicit regions for sizing and alignment that are necessary to support Wasm and similar systems. Notably, a Wasm runtime in the sandbox may opt to place it&#8217;s own data into an implicit data region, to ensure Spectre attacks cannot be used to trick the sandbox runtime into leaking its own data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fault_registers">3.3. Fault Registers</h3>
<div class="paragraph">
<p>The HFI Explicit extension extends the fault status register defined in <a href="#sec_hfi_faults">Chapter 2.4.4</a> with additional fields to capture explicit region faults. Specifically, when an explicit region fault occurs, the <code>hfi_fault_region</code> field indicates which explicit region caused the fault (i.e., region number 3). If the faulted region is an explicit region, the <code>hfi_fault_type</code> will be set to <code>OUT_OF_BOUNDS</code> if the access was out of bound for the explicit region, and <code>INSUFFICIENT_PERMISSIONS</code> if the explicit region did not have sufficient permissions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_explicit_instruction_encoding">3.4. Explicit Instruction Encoding</h3>
<div class="paragraph">
<p>On top of instructions introduced in HFI base extension, HFI explicit extension further introduces "explicit" memory instructions that mimic native load and store instructions but are used exclusively for explicit regions. These instructions are encoded using opcodes that fail if not implemented, ensuring that binaries using explicit regions cannot run inadvertently on non-HFI hardware. However, binaries that only use HFI&#8217;s implicit regions would remain backward compatible on CPUs that don&#8217;t support HFI (albeit without the isolation enforcement).</p>
</div>
<div class="paragraph">
<p>To provide full support for modern RV64GV processors, HFI defines explicit-region variants for the Base Integer set, as well as the Atomic (A), Floating Point (F, D, Q), and Vector (V) extensions.</p>
</div>
<div class="sect3">
<h4 id="_base_loads_and_stores">3.4.1. Base Loads and Stores</h4>
<div class="paragraph">
<p>H-prefixed base loads and stores automatically check against the bounds specified by the explicit region registers. The effective address (EA) calculation matches native instructions, but the base of the region is added to the EA to form the final virtual address. The bound check compares the EA against the region bound. Implementations typically place the bound check logic in parallel with the final address computation or TLB lookup to minimize the critical path.</p>
</div>
<div id="fig_enc_base" class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PHN2ZyBvdmVyZmxvdz0iaGlkZGVuIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIyMzEuMzMxNTYzNTU0NTU1NyAyMjkuOTIwNDggNzk2LjIyMDQ3MjQ0MDk0NDggMTc1LjY4IiBzdHlsZT0ibWF4LWhlaWdodDogNTAwcHgiIHdpZHRoPSI3OTYuMjIwNDcyNDQwOTQ0OCIgaGVpZ2h0PSIxNzUuNjgiPjxnPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNzIwIiB3aWR0aD0iMTI4MCIgeT0iMCIgeD0iMCIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjE1MyIgeT0iMzMwIiB4PSIyMzkiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNjkuNjAxIDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5JbW1bMTE6NV08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTI4IiB5PSIzMzAiIHg9IjM5MiIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0Mi44MzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJzMjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjgiIHk9IjMzMCIgeD0iNTE5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LjkyMSAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cnMxPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9Ijg4IiB5PSIzMzAiIHg9IjY0NyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2My4zNzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjQiIHk9IjMzMCIgeD0iNzM1Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzU1LjYxNyAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+SW1tWzQ6MF08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTYxIiB5PSIzMzAiIHg9Ijg1OSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwOC43MzQgMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm9wY29kZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNzEuNjk5IDM5NCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5PZmZzZXRbMTE6NV08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQwLjY0OCAzOTQpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3JjPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDUxNi43NTEgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPltpZ25vcmVkXSBiYXNlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2NC43ODQgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPndpZHRoPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc0OS4xOTUgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPk9mZnNldFs0OjBdPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5MS44NzggMzk1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPkg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA3LjIxMSAzOTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+LTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MTQuMzc4IDM5NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5TVE9SRTwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIyNzciIHk9IjIzNSIgeD0iMjM5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzMxLjQyNSAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+SW1tWzExOjBdPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMiIgd2lkdGg9IjEyNyIgeT0iMjM1IiB4PSI1MTYiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NjYuNDg1IDI1OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczE8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTI4IiB5PSIyMzUiIHg9IjY0MyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY5OC4yNjEgMjU5KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJkPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMiIgd2lkdGg9Ijg4IiB5PSIyMzUiIHg9Ijc3MSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc4Ny41NTIgMjU5KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIxNjEiIHk9IjIzNSIgeD0iODU5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA4LjczNCAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMi4wMzYgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPk9mZnNldFsxMTowXTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTMuMzE0IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5baWdub3JlZF0gYmFzZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3ODguOTU4IDI5OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj53aWR0aDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4OTEuODc4IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5IPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwNy4yMTEgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTE0LjM3OCAyOTgpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+TE9BRDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2ODYuMjYzIDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5kZXN0PC90ZXh0PjwvZz48L3N2Zz4=" alt="enc base cropped" width="70%">
</div>
<div class="title">Figure 2. H-prefixed Base Loads and Stores</div>
</div>
<table id="tab_enc_base" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Encodings for h-prefixed base loads and stores</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct3</th>
<th class="tableblock halign-center valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlwu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hsb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlw</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hsh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hld</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hsw</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlbu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hsd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlhu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_floating_point_loads_and_stores">3.4.2. Floating Point Loads and Stores</h4>
<div class="paragraph">
<p>H-prefixed Floating Point (FP) loads and stores are encoded under the same opcode as standard FP instructions but differentiated with a 3-bit width field. They behave identically to base loads/stores but utilize the floating point register file.</p>
</div>
<div id="fig_enc_fp" class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PHN2ZyBvdmVyZmxvdz0iaGlkZGVuIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIyMzEuMzMxNTYzNTU0NTU1NyAyMjkuOTIwNDggNzk2LjIyMDQ3MjQ0MDk0NDggMTc1LjY4IiBzdHlsZT0ibWF4LWhlaWdodDogNTAwcHgiIHdpZHRoPSI3OTYuMjIwNDcyNDQwOTQ0OCIgaGVpZ2h0PSIxNzUuNjgiPjxnPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNzIwIiB3aWR0aD0iMTI4MCIgeT0iMCIgeD0iMCIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjE1MyIgeT0iMzMwIiB4PSIyMzkiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNjkuNjAxIDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5JbW1bMTE6NV08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTI4IiB5PSIzMzAiIHg9IjM5MiIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0Mi44MzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJzMjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjgiIHk9IjMzMCIgeD0iNTE5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LjkyMSAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cnMxPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9Ijg4IiB5PSIzMzAiIHg9IjY0NyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2My4zNzggMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjQiIHk9IjMzMCIgeD0iNzM1Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzU1LjYxNyAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+SW1tWzQ6MF08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTYxIiB5PSIzMzAiIHg9Ijg1OSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwOC43MzQgMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm9wY29kZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNzEuNjk5IDM5NCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5PZmZzZXRbMTE6NV08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQwLjY0OSAzOTQpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3JjPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDUxNi43NTEgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPltpZ25vcmVkXSBiYXNlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2NC43ODQgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPndpZHRoPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc0OS4xOTUgMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPk9mZnNldFs0OjBdPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg4MC4xMzMgMzk1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPkg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODk1LjQ2NiAzOTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+LTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MDIuNjMzIDM5NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5TVE9SRS5GUDwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIyNzciIHk9IjIzNSIgeD0iMjM5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzMxLjQyNSAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+SW1tWzExOjBdPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMiIgd2lkdGg9IjEyNyIgeT0iMjM1IiB4PSI1MTYiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NjYuNDg1IDI1OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczE8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTI4IiB5PSIyMzUiIHg9IjY0MyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY5OC4yNjEgMjU5KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJkPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMiIgd2lkdGg9Ijg4IiB5PSIyMzUiIHg9Ijc3MSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc4Ny41NTIgMjU5KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIxNjEiIHk9IjIzNSIgeD0iODU5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA4LjczNCAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMi4wMzYgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPk9mZnNldFsxMTowXTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTMuMzE0IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5baWdub3JlZF0gYmFzZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3ODguOTU4IDI5OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj53aWR0aDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4ODQuMTU5IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5IPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5OS40OTIgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA2LjY1OSAyOTgpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+TE9BRC5GUDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2ODYuMjYzIDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5kZXN0PC90ZXh0PjwvZz48L3N2Zz4=" alt="enc fp cropped" width="70%">
</div>
<div class="title">Figure 3. H-prefixed floating point loads and stores</div>
</div>
<table id="tab_enc_fp" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Encodings for h-prefixed FP loads and stores</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct3</th>
<th class="tableblock halign-center valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hflw</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfsw</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfld</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfsd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hflq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfsq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_vector_memory_operations">3.4.3. Vector Memory Operations</h4>
<div class="paragraph">
<p>Vector memory instructions complicate bound checking because a single instruction accesses multiple memory locations. H-prefixed vector instructions reuse the HFI FP opcodes but retain the standard Vector extension encoding for <code>mop</code> (addressing mode) and <code>nf</code> (segment size) fields.</p>
</div>
<div class="paragraph">
<p>For strided and indexed instructions: Since these can address disparate parts of memory, HFI checks the entire segment against region bounds for every effective address. To avoid the cost of a full 64-bit adder for every element, implementations can utilize the limited segment size (dictated by <code>vlen</code> and <code>nf</code>). A cheaper 16-bit adder and 48-bit incrementor (for <code>vlen &#8656; 4096</code>) is sufficient to calculate the segment end address.</p>
</div>
<div class="paragraph">
<p>For unit-stride instructions: These access contiguous memory. Implementations may optimize by only checking the end address of the last segment, though this requires a multiplier.</p>
</div>
<div id="fig_enc_vec" class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PHN2ZyBvdmVyZmxvdz0iaGlkZGVuIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIyMzguMDM1MzY1NTc5MzAyNiAyMzkuNTE5NTIgODM2LjUzNTQzMzA3MDg2NiAyNjkuMjgiIHN0eWxlPSJtYXgtaGVpZ2h0OiA1MDBweCIgd2lkdGg9IjgzNi41MzU0MzMwNzA4NjYiIGhlaWdodD0iMjY5LjI4Ij48Zz48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjcyMCIgd2lkdGg9IjEyODAiIHk9IjAiIHg9IjAiLz48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSI1NCIgeT0iMzQyIiB4PSIyNDciLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNjUuMTc1IDM2NykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5uZjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSI2NCIgeT0iMzQyIiB4PSIzMDEiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTIuMzYzIDM2NykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5tZXc8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iNzMiIHk9IjM0MiIgeD0iNjkwIi8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzAxLjk4NSAzNjcpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+d2lkdGg8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTAzIiB5PSIzNDIiIHg9Ijc2MyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc5OS43NjUgMzY3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnZzMzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxNjIiIHk9IjM0MiIgeD0iODY2Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTE2LjMyNCAzNjcpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwOSA0MDYpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3RyaWRlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDU4My42MjQgNDA2KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPltpZ25vcmVkXSBiYXNlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg3OC4zNTcgNDA3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPkg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODkzLjY5IDQwNykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj4tPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwMC44NTcgNDA3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPkxPQUQvU1RPUkUuRlA8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iNjQiIHk9IjM0MiIgeD0iMzY1Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzc4LjM0MyAzNjcpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+bW9wPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjU0IiB5PSIzNDIiIHg9IjQyOSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0Mi41MjggMzY3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnZtPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjEwNCIgeT0iMzQyIiB4PSI1ODYiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MjQuOTU0IDM2NykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczE8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTA0IiB5PSIzNDIiIHg9IjQ4MyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDUyMS45NzkgMzY3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJzMjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSI1NCIgeT0iMjUxIiB4PSIyNDciLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNjUuMTc1IDI3NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5uZjwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSI2NCIgeT0iMjUxIiB4PSIzMDEiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTIuMzYzIDI3NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5tZXc8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iNzMiIHk9IjI1MSIgeD0iNjkwIi8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzAxLjk4NSAyNzUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+d2lkdGg8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTAzIiB5PSIyNTEiIHg9Ijc2MyIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc5OS43NjUgMjc1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnZzMzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIxNjIiIHk9IjI1MSIgeD0iODY2Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTE2LjMyNCAyNzUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1NS4yNTEgMzE1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnNlZzwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MDUuNDY2IDMxNSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5vcHRpb248L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTgzLjMzNSAzMTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+W2lnbm9yZWRdIGJhc2U8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzgzLjMwNyAzMTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3JjPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDgwOC4zMDcgMzE1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi88L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODE0LjMwNyAzMTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+ZGVzdDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NzUuNzQ3IDMxNCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5IPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5MS4wODEgMzE0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODk4LjI0NyAzMTQpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+TE9BRC9TVE9SRS5GUDwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSI2NCIgeT0iMjUxIiB4PSIzNjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNzguMzQzIDI3NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5tb3A8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iNTQiIHk9IjI1MSIgeD0iNDI5Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQyLjUyOCAyNzUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+dm08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTA0IiB5PSIyNTEiIHg9IjU4NiIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyNC45NTQgMjc1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJzMTwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSIxMDQiIHk9IjI1MSIgeD0iNDgzIi8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTAwLjI2NCAyNzUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+bC88L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTEyLjI2NCAyNzUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3Vtb3A8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjU5LjYwOSA0MDYpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c2VnPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjU1IiB5PSI0MzEiIHg9IjI0NiIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2NC45NDUgNDU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm5mPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjY0IiB5PSI0MzEiIHg9IjMwMSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMxMi4xMzQgNDU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm1ldzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSI3MyIgeT0iNDMxIiB4PSI2OTAiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MDEuNzU1IDQ1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj53aWR0aDwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMDMiIHk9IjQzMSIgeD0iNzYzIi8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzk5LjUzNSA0NTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+dnMzPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjE2MiIgeT0iNDMxIiB4PSI4NjYiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MTYuMDk1IDQ1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5vcGNvZGU8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTA2LjYxMyA0OTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b2Zmc2V0czwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1ODMuMzk0IDQ5NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5baWdub3JlZF0gYmFzZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NzYuOTU2IDQ5NikiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5IPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDg5Mi4yOSA0OTYpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+LTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4OTkuNDU2IDQ5NikiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5MT0FEL1NUT1JFLkZQPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjY0IiB5PSI0MzEiIHg9IjM2NSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDM3OC4xMTQgNDU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPm1vcDwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSI1NCIgeT0iNDMxIiB4PSI0MjkiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NDIuMjk4IDQ1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj52bTwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMDQiIHk9IjQzMSIgeD0iNTg2Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjI0LjcyNSA0NTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cnMxPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjEwNCIgeT0iNDMxIiB4PSI0ODMiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTkuOTk5IDQ1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj52czI8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjU5LjM3OSA0OTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c2VnPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc4My4xMTMgNDA3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnNyYzwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MDguMTEzIDQwNykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj4vPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDgxNC4xMTMgNDA3KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmRlc3Q8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzgyLjQwNCA0OTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3JjPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDgwNy40MDQgNDk1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi88L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODEzLjQwNCA0OTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+ZGVzdDwvdGV4dD48L2c+PC9zdmc+" alt="enc vec cropped" width="80%">
</div>
<div class="title">Figure 4. H-prefixed vector loads and stores</div>
</div>
<table id="tab_enc_vec" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Field encodings for vector loads and stores</caption>
<colgroup>
<col style="width: 13.3333%;">
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 20.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>mop</code></th>
<th class="tableblock halign-left valign-top">Addressing Mode</th>
<th class="tableblock halign-left valign-top"><code>funct3</code></th>
<th class="tableblock halign-left valign-top">Width</th>
<th class="tableblock halign-left valign-top"><code>opcode</code></th>
<th class="tableblock halign-left valign-top">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unit stride</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">h-load</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index (unordered)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">half-word</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">h-store</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">constant stride</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">word</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index (ordered)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double-word</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_atomic_memory_operations">3.4.4. Atomic Memory Operations</h4>
<div class="paragraph">
<p>For H-prefixed Atomic Memory Operations (AMOs), the hardware first computes the effective address (EA) and adds the explicit region base to determine the final address. The EA is checked against the region bound before the atomic operation proceeds.</p>
</div>
<div class="paragraph">
<p><strong>Fault Handling</strong>
Because AMOs represent complex Read-Modify-Write sequences, a specific <code>AMO_FAULT</code> encoding (<code>11</code>) is introduced in the <code>hfi_fault_op</code> field of the fault status register. This differentiates atomic faults from simple load/store faults, mirroring standard RISC-V exception handling. Upon an out-of-bounds AMO, the hardware inhibits the write-back stage to prevent data corruption and traps to the kernel.</p>
</div>
<div id="fig_enc_amo" class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PHN2ZyBvdmVyZmxvdz0iaGlkZGVuIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIyMzEuMzMxNTYzNTU0NTU1NyAyMjkuOTIwNDggNzk2LjIyMDQ3MjQ0MDk0NDggMjA0LjQ4IiBzdHlsZT0ibWF4LWhlaWdodDogNTAwcHgiIHdpZHRoPSI3OTYuMjIwNDcyNDQwOTQ0OCIgaGVpZ2h0PSIyMDQuNDgiPjxnPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNzIwIiB3aWR0aD0iMTI4MCIgeT0iMCIgeD0iMCIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9Ijk0IiB5PSIzMzAuNSIgeD0iMjM5LjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTguODQ4IDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5mdW5jdDU8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTIyIiB5PSIzMzAuNSIgeD0iNDEwLjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NTguMDM5IDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczI8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iMTIzIiB5PSIzMzAuNSIgeD0iNTMyLjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1ODAuNjc4IDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczE8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMzIiB3aWR0aD0iODAiIHk9IjMzMC41IiB4PSI2NTUuNSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2Ny41NjYgMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmZ1bmN0MzwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIxLjMzMzMzIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSIxMjQiIHk9IjMzMC41IiB4PSI3MzUuNSIvPjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDc4Ny43ODQgMzU1KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPnJkPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjE2MSIgeT0iMzMwLjUiIHg9Ijg1OS41Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA4LjczNCAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI1NS44NjggMzkzKSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPkg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjcxLjIwMSAzOTMpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+LTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNzguMzY4IDM5MykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5MUjwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NjguNTU4IDM5NCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj4wPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDU3Mi41MjggMzk0KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmFkZHI8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjY4LjkxMyAzOTQpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+d2lkdGg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzc2LjAzNCAzOTQpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+ZGVzdDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MTMuNTY2IDM5NykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5BTU88L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMjc3IiB5PSIyMzUuNSIgeD0iMjM5LjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzEuNDI1IDI1OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5JbW1bMTE6MF08L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTI3IiB5PSIyMzUuNSIgeD0iNTE2LjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NjYuNDg1IDI1OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yczE8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIgc3Ryb2tlPSIjMDAwMDAwIiBoZWlnaHQ9IjMyIiB3aWR0aD0iMTI4IiB5PSIyMzUuNSIgeD0iNjQzLjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2OTguMjYxIDI1OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5yZDwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIxLjMzMzMzIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzIiIHdpZHRoPSI4OCIgeT0iMjM1LjUiIHg9Ijc3MS41Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzg3LjU1MiAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+ZnVuY3QzPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMiIgd2lkdGg9IjE2MSIgeT0iMjM1LjUiIHg9Ijg1OS41Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTA4LjczNCAyNTkpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+b3Bjb2RlPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMi4wMzYgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPk9mZnNldFsxMTowXTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTMuMzE0IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5baWdub3JlZF0gYmFzZTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3ODguOTU4IDI5OSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj53aWR0aDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4OTEuODc4IDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5IPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwNy4yMTEgMjk4KSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPi08L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTE0LjM3OCAyOTgpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+TE9BRDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2ODYuMjYzIDI5OCkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5kZXN0PC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1taXRlcmxpbWl0PSI4IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiIHN0cm9rZT0iIzAwMDAwMCIgaGVpZ2h0PSIzMyIgd2lkdGg9IjQwIiB5PSIzMzAuNSIgeD0iMzMzLjUiLz48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNDMuMjAyIDM1NSkiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5hcTwvdGV4dD48cmVjdCBmaWxsPSIjRkZGRkZGIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLXdpZHRoPSIxLjMzMzMzIiBzdHJva2U9IiMwMDAwMDAiIGhlaWdodD0iMzMiIHdpZHRoPSI0MCIgeT0iMzMwLjUiIHg9IjM3My41Ii8+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzg2Ljc5OCAzNTUpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+cmw8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM5LjQ5OCA0MjMpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+SDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTQuODMxIDQyMykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj4tPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MS45OTggNDIzKSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPlNDLCBBTU88L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ3LjE1MSA0MjMpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+LTwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNTQuMzE4IDQyMykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5PUHM8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDYzLjM5NiA0MjIpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+c3JjPC90ZXh0Pjx0ZXh0IHRyYW5zZm9ybT0idHJhbnNsYXRlKDU3Mi41MjggNDIyKSIgZm9udC1zaXplPSIyMS4zMzMzIiBmb250LXdlaWdodD0iNDAwIiBmb250LWZhbWlseT0iVGltZXMgTmV3IFJvbWFuLFRpbWVzIE5ldyBSb21hbl9NU0ZvbnRTZXJ2aWNlLHNhbnMtc2VyaWYiPmFkZHI8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjY4LjkxMyA0MjIpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+d2lkdGg8L3RleHQ+PHRleHQgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzc2LjAzNCA0MjIpIiBmb250LXNpemU9IjIxLjMzMzMiIGZvbnQtd2VpZ2h0PSI0MDAiIGZvbnQtZmFtaWx5PSJUaW1lcyBOZXcgUm9tYW4sVGltZXMgTmV3IFJvbWFuX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiI+ZGVzdDwvdGV4dD48dGV4dCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MTMuNTY2IDQyMykiIGZvbnQtc2l6ZT0iMjEuMzMzMyIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1mYW1pbHk9IlRpbWVzIE5ldyBSb21hbixUaW1lcyBOZXcgUm9tYW5fTVNGb250U2VydmljZSxzYW5zLXNlcmlmIj5BTU88L3RleHQ+PC9nPjwvc3ZnPg==" alt="enc amo cropped" width="70%">
</div>
<div class="title">Figure 5. H-prefixed atomic loads, stores and other atomic operations</div>
</div>
<table id="tab_enc_base_amo" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Encodings for h-prefixed atomic memory instructions</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct5</th>
<th class="tableblock halign-center valign-top">Opcode</th>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Funct5</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hlr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00101</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamoor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01101</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hsc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00110</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamomin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01110</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamoswap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00111</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamomax</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01111</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamoadd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamominu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamoxor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01010</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamomaxu</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10010</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hamoand</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01011</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sub_subsec_standard_profile">3.5. HFI Versions (Profiles)</h3>
<div class="paragraph">
<p>In the future standard profile we aim to develop  up to 4 explicit data regions. The minimal profile described in this document supports: 1 implicit code region, 1 implicit data region and 1 explicit data region. The additional standard profile supports: 2 implicit code regions, 4 implicit data regions, and 4 explicit data regions. These regions are numbered as follows: explicit data region 1, implicit data region 1 and implicit code region 1 are regions 1, 2, and 3 in both profiles. In the standard profile: explicit data region 2, 3, and 4 are regions 4, 5, and 6 respectively; implicit data region 2, 3, and 4 are regions 7, 8, and 9 respectively; implicit code region 2 is region 10. Additionally the permissions bit vector operand specified in the <code>hfisetregionpermission</code> and <code>hfigetregionpermission</code> instructions is also expanded to accommodate region permissions in the same order.</p>
</div>
<div class="paragraph">
<p>Therefore, an instruction (<code>hfisetcurrexplicitdataregion</code> and <code>hfigetcurrexplicitdataregion</code>) that sets which explicit region the h-prefixed instructions will use is needed. <code>hfisetcurrexplicitdataregion</code> always precedes the h-prefixed instructions and takes the region number from its <code>rs1</code>. The instruction pair also double-checks the region number to ensure that it references an explicit region.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hfisetcurrexplicitdataregion(region_number_t)</code></p>
</li>
<li>
<p><code>hfigetcurrexplicitdataregion() &#8594; region_number_t</code></p>
</li>
</ul>
</div>
<table id="tab_enc_non_h_explicit" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Encoding for R-type Non-h-prefixed Instructions (Explicit Only)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">funct3</th>
<th class="tableblock halign-left valign-top">funct7</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfigetcurrexplicitdataregion</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hfisetcurrexplicitdataregion</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Design Rationale</strong>
Regions exact some cost in terms of circuit area, and differing trade-offs may make sense for different use cases. Obviously more regions facilitate efficient access to more data and code concurrently, and can simplify runtime implementation.</p>
</div>
<div class="paragraph">
<p>While the minimal profile is limited in the number of regions, this can still offer meaningful benefits for certain use cases without significant concurrency or memory sharing. For example, the Google Chrome browser&#8217;s Ubercage JIT isolation scheme <span class="citation">(<a href="#v8-sbx">saelo&#44; 2021</a>)</span> would be able to leverage this minimal profile for its isolation requirements <span class="citation">(<a href="#v8-sbx-hfi">Groß saelo&#44; 2024</a>)</span>.</p>
</div>
<div class="paragraph">
<p>The standard profile offers an expanded number of regions. The particular number of regions was inspired by uses cases such as leveraging WebAssembly for efficient isolation of libraries from applications, and efficient isolation of different clients' code in serverless settings <span class="citation">(<a href="#hfi">Narayan et al.&#44; 2023</a>)</span>. The main observation here is that there is greater concurrency and sharing is present than simple use cases, but this can nevertheless be handled efficiently with a handful of regions. For uses cases that need additional regions, this can be achieved by spilling and restoring regions similar to how this is done with general-purpose registers.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v1<br>
</div>
</div>
</body>
</html>